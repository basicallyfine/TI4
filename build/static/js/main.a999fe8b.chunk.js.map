{"version":3,"sources":["lib/rolling-calculator.js","lib/constants.js","components/dice-table.js","lib/utils.js","components/map-builder/map-constants.js","components/map-builder/SystemTileSVG.js","components/map-builder/SystemTileKonvaStage.js","components/map-builder/SystemTile.js","components/map-builder/HomeSystemTile.js","components/map-builder/MapPlace.js","components/map-builder/MapContainer.js","components/map-builder/TileDisplay.js","components/map-builder/StatsTable.js","components/common/modal.js","components/map-builder/MapStringModal.js","components/map-builder/index.js","routes.js","index.js"],"names":["calculator","dice","this","map","input","dieValue","parseFloat","_results","calculate","textOutput","out","k","push","Math","round","join","_cumulative","avg","parseInt","text","value","i","outcome","toString","padStart","length","hits","replace","outcomeP","reduce","accumulator","hitValue","dieIndex","GAME_COLOURS","SYSTEM_TILE_BACK","TECH_COLOR","PLANET_TRAIT","ANOMALY","WORMHOLE","SYSTEMS","number","back","planets","name","trait","tech","legendary","resources","influence","mecatol","pok","_vm_tier","anomaly","wormhole","RESULT_MODE","_calcs","getCalculation","split","formatPercent","float","undefined","rounded","interpolateColours","colour0","colour1","p","colourP","channel0","summariseDice","inputString","sort","DiceTable","useState","resultMode","setResultMode","inputs","setInputs","focus","setFocus","useEffect","resultModeLabel","maxHits","_","chain","max","valueRange","min","Infinity","headerCols","data","filter","uniqBy","inputIndex","result","cols","key","average","className","onSubmit","event","preventDefault","focused","target","querySelector","blur","index","type","inputMode","placeholder","style","width","autoFocus","onChange","e","updateInputs","clone","onBlur","onFocus","tabIndex","onClick","splice","position","left","top","v","href","scope","rowIndex","colIndex","backgroundColor","toFixed","utils","string","JSON","parse","console","error","MAP_PLACES","MAP_00","MAP_01","MAP_02","MAP_03","MAP_04","MAP_05","MAP_06","MAP_07","MAP_08","MAP_09","MAP_10","MAP_11","MAP_12","MAP_13","MAP_14","MAP_15","MAP_16","MAP_17","MAP_18","MAP_19","MAP_20","MAP_21","MAP_22","MAP_23","MAP_24","MAP_25","MAP_26","MAP_27","MAP_28","MAP_29","MAP_30","MAP_31","MAP_32","MAP_33","MAP_34","MAP_35","MAP_36","MAP_PLACE_POSITION","zIndex","SYSTEM_PNG_URL","MAP_OPTION","THREE_PLAYER","FOUR_PLAYER","MAP_CONFIG","systems","blue","red","players","label","hs","adjacent","slice","equidistant","SIX_PLAYER","TILE_DISPLAY_TYPE","children","xmlns","viewBox","d","WIDTH","HEIGHT","PT","COLOR","WHITE","BLACK","RED","GREEN","BLUE","YELLOW","ORANGE","PINK","GREY","OBJECT_TYPE","OBJECT_RADIUS","OBJECT_LARGE_RADIUS","OBJECT_STROKE_WIDTH","OBJECT_STROKE_DASH","TEXT_PROPS","BASE","fontFamily","fontStyle","fill","align","verticalAlign","lineHeight","OBJECT_LABEL","fontSize","SYSTEM_LABEL","PLANET_VALUES","TextWithFont","props","fontLoaded","setFontLoaded","a","font","FontFaceObserver","weight","load","catch","log","AnomalyBorder","size","corner","angle","points","stroke","closed","strokeWidth","x","y","offsetX","rotation","PlanetIcon","planet","numPoints","offsetY","outerRadius","innerRadius","iconProps","height","Planet","planetProps","radius","labelProps","toUpperCase","labelMarginY","labelMarginX","planetValueProps","iconMargin","icon","iconSize","AnomalyObject","textBoxSize","dash","WormholeObject","wormholeProps","color","SystemObject","object","SystemObjects","system","objects","get","objectType","positionProps","SystemNumber","SystemTileContents","memo","prevProps","nextProps","isEqual","SystemTileContent","find","src","alt","draggable","SystemTileSVG","SystemTileKonvaStage","SystemTile","contentType","locked","toggleLocked","useDrag","item","canDrag","collect","monitor","isDragging","place","collected","dragRef","classes","ref","onDoubleClick","role","player","HomeSystemTile","placeWrapperStyle","MapPlace","playerHome","moveTile","unavailable","toggleLockedPlace","useDrop","accept","drop","canDrop","isOver","dropRef","MapContainer","mapPlaceData","displayType","toPairs","TileDisplay","SYSTEM_GROUPS","ADJACENT","SLICE","EQUIDISTANT","StatsTable","mapConfig","includedSystems","setIncludedSystems","mapValues","uniq","places","summary","tiles","flatten","sumBy","efficientValue","traits","anomalies","wormholes","nonPlanet","summariseSystems","group","id","checked","indexOf","prevGroups","values","includedGroup","setIncludedSystemGroup","htmlFor","colSpan","systemGroup","systemGroupIdx","rowSpan","memoCompare","oldProps","_memo","newProps","Modal","state","show","transitionDelay","setShow","bind","keyboardClose","close","renderContents","setState","document","addEventListener","transitionTimeout","clearTimeout","removeEventListener","transitioning","setTimeout","dismissible","onClose","custom","modalSize","portal","fade","wrapperClasses","modalWrapper","portalNode","getElementById","createPortal","Component","CloseButton","floating","button","data-dismiss","aria-label","aria-hidden","Header","title","Body","Footer","MapStringModal","setValue","cleanupString","initialValue","clean","STORAGE_KEYS","defaultMapPlaceData","placeData","forEach","parseMapString","sortBy","substr","cleanMapData","usedSystems","fromPairs","MapBuilder","location","useLocation","history","useHistory","query","URLSearchParams","hash","initialMapOption","option","window","localStorage","getItem","mapOption","initialMapPlaceData","parseJSON","useInitialMapState","setMapOption","setMapPlaceData","tileDisplayType","setTileDisplayType","mapString","setMapString","mapStringDialog","setMapStringDialog","resetMapConfig","setItem","match","stringify","useLayoutEffect","unassignedSystems","without","moveTiles","alreadyMoved","newState","existingSystem","prevPlace","findKey","config","defaultData","entries","emptyMap","pickBy","DndProvider","backend","HTML5Backend","prevState","newPlaceData","randomSystems","shuffle","keys","shuffledMap","empty","fromString","setMapFromString","createBrowserHistory","Routes","path","component","to","ReactDOM","render","StrictMode"],"mappings":"qVAmFMA,E,WACF,aAAsB,+CAAPC,EAAM,yBAANA,EAAM,gBACjBC,KAAKD,KAAOA,EAAKE,KAAI,SAACC,GAClB,IAAIC,EAAWC,WAAWF,EAAO,IAIjC,OAHiB,IAAbC,IACAA,EAAW,IAERA,K,yCAGf,WAII,GAHKH,KAAKK,UACNL,KAAKM,YAELN,KAAKO,WAAY,CACjB,IAAMC,EAAM,GACZ,IAAK,IAAMC,KAAKT,KAAKK,SACjBG,EAAIE,KAAJ,UAAYD,EAAZ,aAAkBE,KAAKC,MAAyB,IAAnBZ,KAAKK,SAASI,IAA3C,MAEJ,OAAOD,EAAIK,KAAK,MAEpB,OAAOb,KAAKK,W,sBAEhB,WAII,GAHKL,KAAKc,aACNd,KAAKM,YAELN,KAAKO,WAAY,CACjB,IAAMC,EAAM,GACZ,IAAK,IAAMC,KAAKT,KAAKc,YACjBN,EAAIE,KAAJ,aAAeD,EAAf,aAAqBE,KAAKC,MAA4B,IAAtBZ,KAAKc,YAAYL,IAAjD,MAEJ,OAAOD,EAAIK,KAAK,MAEpB,OAAOb,KAAKc,c,mBAEhB,WACE,IAAIC,EAAM,EACV,IAAK,IAAMN,KAAKT,KAAKK,SACnBU,GAAOC,SAASP,EAAG,IAAMT,KAAKK,SAASI,GAGzC,OAAOM,I,oBAGT,WAAqB,IAAdE,IAAa,yDAEhB,OADAjB,KAAKO,WAAaU,EACXjB,O,uBAEX,WAAa,IAAD,OACRA,KAAKK,SAAW,GAChBL,KAAKc,YAAc,GAELd,KAAKD,KAAKE,KAAI,SAACiB,GAAD,OAAY,GAAKA,GAAS,MACtD,IADA,IAJQ,WAKCC,GACL,IAAMC,EAAUD,EAAEE,SAAS,GAAGC,SAAS,EAAKvB,KAAKwB,OAAQ,KACnDC,EAAOJ,EAAQK,QAAQ,KAAM,IAAIF,OACjCG,EAAW,EAAK3B,KAAK4B,QAAO,SAACC,EAAaC,EAAUC,GAKtD,OAAOF,GAHmB,MAAtBR,EAAQU,IACD,GAAKD,GAAY,GAClB,GAAK,GAAKA,GAAY,MAEjC,GAEE,EAAKxB,SAASmB,EAAKH,SAAS,OAC7B,EAAKhB,SAASmB,EAAKH,SAAS,KAAO,GAEvC,EAAKhB,SAASmB,EAAKH,SAAS,MAAQK,GAd/BP,EAAI,EAAGA,EAAC,SAAG,EAAKnB,KAAKD,KAAKwB,QAAQJ,GAAK,EAAI,EAA3CA,GAiBT,IAAK,IAAIA,EAAInB,KAAKD,KAAKwB,OAAQJ,GAAK,EAAGA,GAAK,EACxCnB,KAAKc,YAAYK,EAAEE,SAAS,KAAOrB,KAAKK,SAASc,EAAEE,SAAS,KACxDrB,KAAKc,aAAaK,EAAI,GAAGE,SAAS,KAClCrB,KAAKc,YAAYK,EAAEE,SAAS,MAAQrB,KAAKc,aACpCK,EAAI,GAAGE,SAAS,KAGrBrB,KAAKc,YAAYK,EAAEE,SAAS,KAAOrB,KAAKK,SAASc,EAAEE,SAAS,KAIpE,OAAOrB,S,KCjKT+B,EACK,UADLA,EAGI,UAHJA,EAKK,UALLA,EAOM,UAPNA,EASM,UATNA,EAWG,UAXHA,EAaI,UAmCJC,EACI,cADJA,EAEG,aAKHC,EACG,UADHA,EAEI,aAFJA,EAGK,SAHLA,EAIM,aAGNC,EACI,WADJA,EAEG,YAFHA,EAGK,aAGLC,EACS,YADTA,EAEc,iBAFdA,EAGM,SAHNA,EAIS,eAGTC,EACC,kBADDA,EAEC,kBAGDC,EAAU,CACZ,CACIC,OAAQ,GACRC,KA/BK,UAgCLC,QAAS,CACL,CAAEC,KAAM,cAAeC,MAAO,KAAMC,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,EAAGC,SAAS,KAG/G,CACIT,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,MAAOC,MAAOR,EAAoBS,KAAMV,EAAgBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAE/GG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,gBAAYC,MAAOR,EAAoBS,KAAMV,EAAkBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNkB,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLG,SAAUf,EACVI,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAErGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLE,QAASf,EACTgB,SAAUf,EACVI,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAoBS,KAAMV,EAAmBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAErHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,WAAYC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACrG,CAAEL,KAAM,OAAQC,MAAOR,EAAoBS,KAAMV,EAAiBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEjHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,WAAYC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,UAAWC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,OAAQC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAErGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,UAAWC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEzGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,WAAYC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAExGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,cAAeC,MAAOR,EAAkBS,KAAMV,EAAiBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,UAAWC,MAAOR,EAAmBS,KAAMV,EAAmBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACjH,CAAEL,KAAM,UAAWC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,kBAAcC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAMC,UAAW,EAAGC,UAAW,IAEzGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACjG,CAAEL,KAAM,OAAQC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEpGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,OAAQC,MAAOR,EAAkBS,KAAMV,EAAgBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAE9GG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,aAAcC,MAAOR,EAAoBS,KAAMV,EAAkBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpH,CAAEL,KAAM,YAAaC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEzGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNkB,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,UAAWC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACnG,CAAEL,KAAM,WAAYC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACtG,CAAEL,KAAM,YAAaC,MAAOR,EAAoBS,KAAMV,EAAkBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,YAAaC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAE3GG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,aAAcC,MAAOR,EAAkBS,KAAMV,EAAgBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEpHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAoBS,KAAMV,EAAmBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,GAChH,CAAEL,KAAM,UAAWC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,aAAcC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACvG,CAAEL,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACnG,CAAEL,KAAM,MAAOC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAErGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,aAAcC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACvG,CAAEL,KAAM,cAAUC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAExGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLE,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,OAAQC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GAChG,CAAEL,KAAM,OAAQC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEpGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,aAAcC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACvG,CAAEL,KAAM,aAAcC,MAAOR,EAAmBS,KAAMV,EAAiBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAmBS,KAAMV,EAAkBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEnHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAExGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNkB,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACnG,CAAEL,KAAM,SAAUC,MAAOR,EAAoBS,KAAMV,EAAgBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAElHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,eAAWC,MAAOR,EAAoBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACrG,CAAEL,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,gBAAYC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEvGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNmB,SAAUf,EACVI,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLE,QAASf,EACTK,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,KAG3G,CACIR,OAAQ,GACRC,KAAMP,EACNmB,SAAUf,EACVI,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAoBS,KAAMV,EAAiBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEnHG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNmB,SAAUf,EACVI,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNkB,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAMC,UAAW,EAAGC,UAAW,IAEtGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNkB,QAASf,EACTK,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNmB,SAAUf,EACVI,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,IAEb,CACIF,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,QAASC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACjG,CAAEL,KAAM,WAAYC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAExGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,SAAUC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACnG,CAAEL,KAAM,SAAUC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLE,QAASf,EACTK,QAAS,CACL,CAAEC,KAAM,UAAWC,MAAOR,EAAkBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,KAG3G,CACIR,OAAQ,GACRC,KAAMP,EACNQ,QAAS,CACL,CAAEC,KAAM,UAAWC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,GACpG,CAAEL,KAAM,WAAYC,MAAOR,EAAmBS,KAAM,KAAMC,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEzGG,SAAU,GAEd,CACIX,OAAQ,GACRC,KAAMP,EACNgB,KAAK,EACLR,QAAS,CACL,CAAEC,KAAM,WAAYC,MAAOR,EAAmBS,KAAMV,EAAmBW,WAAW,EAAOC,UAAW,EAAGC,UAAW,IAEtHG,SAAU,I,gBCxgBZG,EACM,WADNA,EAEG,QAGHC,EAAS,GACf,SAASC,EAAevD,GAItB,OAHKsD,EAAOtD,KACVsD,EAAOtD,GAAQ,YAAID,EAAJ,YAAkBC,EAAKwD,MAAM,MAAKjD,aAE5C+C,EAAOtD,GAGhB,SAASyD,EAAcC,GACrB,QAAcC,IAAVD,EAAqB,MAAO,IAChC,IAAIE,EAAUhD,KAAKC,MAAc,IAAR6C,GASzB,OARgB,MAAZE,IACEF,EAAQ,IACVE,EAAU,OAERF,EAAQ,IACVE,EAAU,QAGR,GAAN,OAAUA,EAAV,KAGF,SAASC,EAAmBC,EAASC,EAASC,GAC5C,IAAMC,EAAUH,EAAQ5D,KAAI,SAACgE,EAAU9C,GAAX,OAAiB8C,GAAaH,EAAQ3C,GAAK8C,GAAYF,KACnF,MAAM,QAAN,OAAeC,EAAQnD,KAAK,KAA5B,KAaF,I,EAAMqD,EAAgB,SAAAC,GAAW,OAAIA,EAAYZ,MAAM,IAAIa,OAAOvD,KAAK,IAAIY,QAAQ,kBAAmB,OAAOA,QAAQ,UAAW,KA4MjH4C,EA9JG,WAChB,MAAoCC,mBAASlB,GAA7C,mBAAOmB,EAAP,KAAmBC,EAAnB,KACA,EAA4BF,mBAAS,IAArC,mBAAOG,EAAP,KAAeC,EAAf,KACA,EAA0BJ,mBAAS,MAAnC,mBAAOK,EAAP,KAAcC,EAAd,KAGAC,qBAAU,WACNH,EAAU,MAYX,IAEH,IAWMI,EAAkBP,IAAenB,EAAoB,UAAY,WAEjE2B,EAAUC,IAAEC,MAAMR,GAAQxE,IAAI,UAAUiF,MAAMhE,QAC9CiE,EAAa,CAAEC,IAAKC,IAAUH,KAAMG,KACpCC,EAAa,GAEbC,EAAOP,IAAEC,MAAMR,GAAQe,SAASC,OAAOvB,GAAejE,KAAI,SAACF,EAAM2F,GAGrE,IAFA,IAAMC,EAASrC,EAAevD,GAAMwE,IAAenB,EAAoB,UAAY,cAC7EwC,EAAO,GACJzE,EAAKoD,IAAenB,EAAoB,EAAI,EAAIjC,GAAK4D,EAAS5D,GAAK,EAAG,CAC7E,IAAMD,EAAQyE,EAAOxE,EAAEE,SAAS,KAC5BH,EAAQiE,EAAWD,MAAKC,EAAWD,IAAMhE,GACzCA,EAAQiE,EAAWC,MAAKD,EAAWC,IAAMlE,GAC7C0E,EAAKlF,KAAKQ,GAES,IAAfwE,GACFJ,EAAW5E,KAAKS,GAGpB,MAAO,CAAE0E,IAAKH,EAAY3F,OAAM6F,OAAME,QAASxC,EAAevD,GAAM+F,YACnE5E,QASH,OACE,sBAAK6E,UAAU,4BAAf,UACE,6DACA,yHAEA,uBACEC,SAAU,SAACC,GACTA,EAAMC,iBACN,IAAMC,EAAUF,EAAMG,OAAOC,cAAc,eACvCF,GAASA,EAAQG,OACrB5B,EAAUD,EAAOe,QAAO,SAAAzF,GAAI,QAAMA,EAAK0B,QAAQ,SAAU,SAE3DsE,UAAU,6BAPZ,UASGtB,EAAOxE,KAAI,SAACF,EAAMwG,GAAP,OACV,sBAAiBR,UAAU,mGAA3B,UACE,uBACES,KAAK,OACLC,UAAU,UACVV,UAAU,yCACV7E,MAAOnB,EACP2G,YAAY,MACZC,MAAO,CAAEC,MAAM,GAAD,OAAiC,GAA3BjG,KAAKuE,IAAI,EAAGnF,EAAKwB,QAAiB,KAAxC,OACdsF,UAAWN,IAAU5B,EACrBmC,SAAU,SAACC,GACT,IAAMC,EAAehC,IAAEiC,MAAMxC,GAC7BuC,EAAaT,GAASQ,EAAEX,OAAOlF,MAAMO,QAAQ,SAAU,IACvDiD,EAAUsC,IAEZE,OAAQ,WAAQtC,EAAS,OACzBuC,QAAS,WAAQvC,EAAS2B,MAE5B,qBAAKR,UAAU,qBAAf,SACE,wBACEA,UAAU,8BACVS,KAAK,SACLY,SAAS,KACTC,QAAS,WACP,IAAML,EAAehC,IAAEiC,MAAMxC,GAC7BuC,EAAaM,OAAOf,EAAO,GAC3B7B,EAAUsC,IAPd,sBAlBMT,MAiCZ,wBACER,UAAU,kCACVS,KAAK,SACLa,QAAS,WACP,IAAML,EAAehC,IAAEiC,MAAMxC,GAC7BuC,EAAatG,KAAK,IAClBgE,EAAUsC,GACVpC,EAASoC,EAAazF,OAAS,IAPnC,0BAYA,uBAAOiF,KAAK,SAASG,MAAO,CAAEY,SAAU,QAASC,KAAM,OAAQC,IAAK,cAE3D,OAAV9C,GAAmD,IAAjCF,EAAOe,QAAO,SAAAkC,GAAC,OAAIA,KAAGnG,QACvC,mBAAGwE,UAAU,mBAAb,SACE,wDAA0B,oCAA1B,YAA6C,kCAA7C,gBAIHR,EAAKhE,OAAS,EACb,sBAAKwE,UAAU,gBAAf,UACE,4BAAG,qDAAuB,mBAAG4B,KAAK,IAAIN,QA5GrB,SAACN,GACxBA,EAAEb,iBAEA1B,EADED,IAAenB,EACHA,EAEAA,IAuGgB,SAAwC0B,IAA/D,eACH,qBAAKiB,UAAU,mBAAf,SACE,wBAAOA,UAAU,QAAjB,UACE,gCACE,+BACE,oBAAI6B,MAAM,QACTtC,EAAWrF,KAAI,SAAAuB,GAAI,OAAI,oBAAIoG,MAAM,MAAM7B,UAAU,cAA1B,SAAoDvE,GAAPA,MACrE,gDAGJ,gCACG+D,EAAKtF,KAAI,WAA0B4H,GAA1B,IAAG9H,EAAH,EAAGA,KAAM6F,EAAT,EAASA,KAAME,EAAf,EAAeA,QAAf,OACR,+BACE,oBAAI8B,MAAM,MAAV,SAAiB1D,EAAcnE,KAC9B6F,EAAK3F,KAAI,SAACiB,EAAO4G,GAAR,OAAqB,oBAAmB/B,UAAU,cAAcY,MAAO,CAAEoB,gBAAkC,kBAAV7G,EAAqB0C,EAAmB,CAAC,GAAI,GAAI,IAAK,CAAC,IAAK,GAAI,MAAO1C,EAAQiE,EAAWC,MAAQD,EAAWD,IAAMC,EAAWC,MAAQ,eAAlN,SAAoO5B,EAActC,IAAzO4G,MACxC,oBAAI/B,UAAU,aAAd,UAA6BpF,KAAKC,MAAgB,GAAVkF,GAAgB,IAAIkC,QAAQ,OAH7D9D,EAAcnE,iBAU/B,S,mCC5PJkI,GAAQ,CAEdA,UAAkB,SAACC,GACf,IACI,OAAOC,KAAKC,MAAMF,GACpB,MAAOnB,GAEL,YADAsB,QAAQC,MAAMvB,MAKPkB,MCTTM,GAAa,CACfC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,SACRC,OAAQ,UAGNC,GAAqB,CACvBrC,OAAQ,CAAEhB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CrC,OAAQ,CAAEjB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CpC,OAAQ,CAAElB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CnC,OAAQ,CAAEnB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/ClC,OAAQ,CAAEpB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CjC,OAAQ,CAAErB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/ChC,OAAQ,CAAEtB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C/B,OAAQ,CAAEvB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C9B,OAAQ,CAAExB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C7B,OAAQ,CAAEzB,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C5B,OAAQ,CAAE1B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C3B,OAAQ,CAAE3B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/C1B,OAAQ,CAAE5B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CzB,OAAQ,CAAE7B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CxB,OAAQ,CAAE9B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CvB,OAAQ,CAAE/B,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CtB,OAAQ,CAAEhC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CrB,OAAQ,CAAEjC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CpB,OAAQ,CAAElC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CnB,OAAQ,CAAEnC,KAAM,QAASC,IAAK,OAAQqD,OAAQ,KAC9ClB,OAAQ,CAAEpC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CjB,OAAQ,CAAErC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/ChB,OAAQ,CAAEtC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/Cf,OAAQ,CAAEvC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/Cd,OAAQ,CAAExC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/Cb,OAAQ,CAAEzC,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CZ,OAAQ,CAAE1C,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CX,OAAQ,CAAE3C,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CV,OAAQ,CAAE5C,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CT,OAAQ,CAAE7C,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CR,OAAQ,CAAE9C,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CP,OAAQ,CAAE/C,KAAM,OAAQC,IAAK,QAASqD,OAAQ,KAC9CN,OAAQ,CAAEhD,KAAM,OAAQC,IAAK,QAASqD,OAAQ,KAC9CL,OAAQ,CAAEjD,KAAM,OAAQC,IAAK,QAASqD,OAAQ,KAC9CJ,OAAQ,CAAElD,KAAM,OAAQC,IAAK,QAASqD,OAAQ,KAC9CH,OAAQ,CAAEnD,KAAM,QAASC,IAAK,QAASqD,OAAQ,KAC/CF,OAAQ,CAAEpD,KAAM,QAASC,IAAK,QAASqD,OAAQ,MAG7CC,GAAc,UHjFD,2EGiFC,wBAEdC,GAAa,CACfC,aAAc,KACdC,YAAa,MAIXC,IAAU,mBACXH,GAAWC,aAAe,CACvBxI,KAAM,eACN2I,QAAS,CACLC,KAAM,GACNC,IAAK,GAETC,QAAS,CACL,CACIC,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAWmC,OACfgB,SAAU,CAACnD,GAAWoC,OAAQpC,GAAWkB,OAAQlB,GAAWkC,QAC5DkB,MAAO,CAACpD,GAAWoC,OAAQpC,GAAWkB,OAAQlB,GAAWkC,OAAQlC,GAAWmB,OAAQnB,GAAWO,OAAQP,GAAWiB,QAClHoC,YAAa,CAACrD,GAAWQ,OAAQR,GAAWE,OAAQF,GAAWM,OAAQN,GAAWgB,UAG1F,CACIiC,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAWuB,OACf4B,SAAU,CAACnD,GAAWsB,OAAQtB,GAAWU,OAAQV,GAAWwB,QAC5D4B,MAAO,CAACpD,GAAWsB,OAAQtB,GAAWU,OAAQV,GAAWwB,OAAQxB,GAAWS,OAAQT,GAAWG,OAAQH,GAAWW,QAClH0C,YAAa,CAACrD,GAAWQ,OAAQR,GAAWE,OAAQF,GAAWI,OAAQJ,GAAWY,UAG1F,CACIqC,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAW6B,OACfsB,SAAU,CAACnD,GAAW8B,OAAQ9B,GAAWc,OAAQd,GAAW4B,QAC5DwB,MAAO,CAACpD,GAAW8B,OAAQ9B,GAAWc,OAAQd,GAAW4B,OAAQ5B,GAAWe,OAAQf,GAAWK,OAAQL,GAAWa,QAClHwC,YAAa,CAACrD,GAAWM,OAAQN,GAAWgB,OAAQhB,GAAWI,OAAQJ,GAAWY,aAhCtF,cAqCX6B,GAAWE,YAAc,CACtBzI,KAAM,cACN2I,QAAS,CACLC,KAAM,GACNC,IAAK,IAETC,QAAS,CACL,CACIC,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAWqC,OACfc,SAAU,CAACnD,GAAWoC,OAAQpC,GAAWmB,OAAQnB,GAAWQ,OAAQR,GAAWoB,QAC/EgC,MAAO,CAACpD,GAAWoC,OAAQpC,GAAWmB,OAAQnB,GAAWQ,OAAQR,GAAWoB,OAAQpB,GAAWqB,OAAQrB,GAAWE,QAClHmD,YAAa,CAACrD,GAAWS,OAAQT,GAAWmC,OAAQnC,GAAWkB,OAAQlB,GAAWO,UAG1F,CACI0C,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAWwB,OACf2B,SAAU,CAACnD,GAAWuB,OAAQvB,GAAWU,OAAQV,GAAWW,OAAQX,GAAWyB,QAC/E2B,MAAO,CAACpD,GAAWuB,OAAQvB,GAAWU,OAAQV,GAAWW,OAAQX,GAAWyB,OAAQzB,GAAWsB,OAAQtB,GAAWG,QAClHkD,YAAa,CAACrD,GAAWS,OAAQT,GAAWI,OAAQJ,GAAWY,OAAQZ,GAAW0B,UAG1F,CACIuB,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAW4B,OACfuB,SAAU,CAACnD,GAAW6B,OAAQ7B,GAAWc,OAAQd,GAAWa,OAAQb,GAAW2B,QAC/EyB,MAAO,CAACpD,GAAW6B,OAAQ7B,GAAWc,OAAQd,GAAWa,OAAQb,GAAW2B,OAAQ3B,GAAW8B,OAAQ9B,GAAWK,QAClHgD,YAAa,CAACrD,GAAWe,OAAQf,GAAWI,OAAQJ,GAAWY,OAAQZ,GAAW0B,UAG1F,CACIuB,MAAO,IACPjE,SAAU,CACNkE,GAAIlD,GAAWiC,OACfkB,SAAU,CAACnD,GAAWkC,OAAQlC,GAAWiB,OAAQjB,GAAWgB,OAAQhB,GAAWgC,QAC/EoB,MAAO,CAACpD,GAAWkC,OAAQlC,GAAWiB,OAAQjB,GAAWgB,OAAQhB,GAAWgC,OAAQhC,GAAWM,OAAQN,GAAW+B,QAClHsB,YAAa,CAACrD,GAAWe,OAAQf,GAAWmC,OAAQnC,GAAWkB,OAAQlB,GAAWO,aA7EtF,cAkFXkC,GAAWa,WAAa,CACrBpJ,KAAM,aACN2I,QAAS,CACLC,KAAM,GACNC,IAAK,IAETC,QAAS,CACL,CACIC,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,KAGrB,CACIJ,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,KAGrB,CACIJ,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,KAGrB,CACIJ,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,KAGrB,CACIJ,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,KAGrB,CACIJ,MAAO,IACPjE,SAAU,CACNkE,GAAI,KACJC,SAAU,GACVC,MAAO,GACPC,YAAa,QA5IjB,GAmJVE,GACI,OADJA,GAEK,QAFLA,GAGG,M,oBC9OM,mBAAGC,EAAH,EAAGA,SAAH,OACX,sBAAKhG,UAAU,cAAf,UACI,qBAAKiG,MAAM,+BAA+BC,QAAQ,cAAclG,UAAU,0BAA1E,SACI,sBAAMmG,EAAE,+EAEXH,M,qGCUHI,GAAQ,IACRC,GAASzL,KAAKC,MAAc,QAARuL,IAEpBE,GAAKF,KAELG,GAAQ,CACZC,MAAOxK,EACPyK,MAAO,UACPC,IAAK1K,EACL2K,MAAO3K,EACP4K,KAAM5K,EACN6K,OAAQ7K,EACR8K,OAAQ9K,EACR+K,KAAM/K,EACNgL,KAAM,WAGFC,GACI,SADJA,GAEK,UAFLA,GAGM,WAGNC,GAAgBd,MAChBe,GAAsBf,MACtBgB,GAAsB,KACtBC,GAAqB,CAACD,KAAyBA,MAE/CE,GAAa,CACjBC,KAAM,CACJC,WAAY,cACZC,UAAW,OACXC,KAAMnB,GAAMC,MACZmB,MAAO,SACPC,cAAe,SACfC,WAAY,KAEdC,aAAc,CAAEC,SAAU,QAC1BC,aAAc,CAAED,SAAU,QAC1BE,cAAe,CAAEF,SAAU,EAAIzB,KAG3B4B,GAAe,SAAC,GAAuB,IAArBpI,EAAoB,EAApBA,IAAQqI,EAAY,kBAC1C,EAAoC5J,oBAAS,GAA7C,mBAAO6J,EAAP,KAAmBC,EAAnB,KAaA,OAXAvJ,oBAAS,wBAAC,6BAAAwJ,EAAA,6DAEFC,EAAO,IAAIC,KAAiB,cAAe,CAC/CC,OAAQ,MAHF,SAKFF,EAAKG,OAAOC,OAAM,WACtBrG,QAAQsG,IAAI,iCANN,OAQRP,GAAc,GARN,2CASP,IAEED,EACE,cAAC,KAAD,eAAoBD,GAATrI,GADM,MAIpB+I,GAAgB,WACpB,IACMC,EAAe,IAAR1C,GACP2C,EAAS,SAACC,GAAD,OACb,cAAC,KAAD,CACEC,OAAQ,CACN,GAAW,EAARH,EACHA,UAAe,EACf,EAAGA,GAELI,OAAQ3C,GAAMG,IACdyC,QAAQ,EACRC,YAXU,KAYVC,EAAGjD,IACHkD,EAAGjD,GAAS,EACZkD,SAASnD,OACToD,SAAUR,KAId,OACE,eAAC,KAAD,WACCD,GAAQ,KACRA,GAAQ,IACRA,EAAO,GACPA,EAAO,IACPA,EAAO,SAKNU,GAAa,SAAC,GAAgC,IAA9BC,EAA6B,EAA7BA,OAAQZ,EAAqB,EAArBA,KAASX,EAAY,kBACjD,IAAKuB,EAEH,OADApH,QAAQC,MAAM,Y,WACP,KAGT,GAAImH,EAAO7M,UAAW,OACpB,cAAC,KAAD,aACE8M,UAAW,EACXjC,KAAMnB,GAAMS,KACZ4C,QAAgB,GAAPd,EACTe,YAAoB,GAAPf,EACbgB,YAAoB,IAAPhB,GACTX,IAIR,IAAM4B,EAAS,aACblJ,MAAOiI,EACPkB,OAAQlB,EACRc,QAAgB,GAAPd,GACNX,GAGL,OAAQuB,EAAO9M,MACb,KAAKV,EACH6N,EAAUrC,KAAOnB,GAAMI,MACzB,MACA,KAAKzK,EACH6N,EAAUrC,KAAOnB,GAAMM,OACzB,MACA,KAAK3K,EACH6N,EAAUrC,KAAOnB,GAAMK,KACzB,MACA,KAAK1K,EACH6N,EAAUrC,KAAOnB,GAAMG,IACzB,MACA,QACE,OAAO,KAGX,OAAO,cAAC,KAAD,eAAYqD,KAGfE,GAAS,SAAC,GAA0B,IAAxBzI,EAAuB,EAAvBA,SAAUkI,EAAa,EAAbA,OACpBQ,EAAc,CAClBC,OAAST,EAAO1M,SAAW0M,EAAO7M,UAAasK,GAAsBD,GACrEgC,OAAQ3C,GAAMC,MACd4C,YAAahC,IAETgD,EAAU,uCACX9C,GAAWC,MACXD,GAAWQ,cAFA,IAGd5M,KAAMwO,EAAOhN,KAAK2N,cAClBhB,EAAG,EACHC,EAAG,IAGCgB,EAAyC,EAA1BJ,EAAYd,YAAwC,GAAtBgB,EAAWrC,SACxDwC,EAAyC,IAA1BL,EAAYd,YAEjC,OAAQ5H,GACN,IAAK,MACH4I,EAAWvJ,MAAQuF,MACnBgE,EAAWJ,OAAkB,GAAT3D,GACpB+D,EAAWf,EAAIa,EAAYC,OAASI,EACpCH,EAAWR,QAA8B,GAApBQ,EAAWJ,OAChCI,EAAWxC,cAAgB,SAC3BwC,EAAWzC,MAAQ,OACrB,MACA,IAAK,MACHyC,EAAWvJ,MAAQuF,MACnBgE,EAAWJ,OAAkB,GAAT3D,GACpB+D,EAAWb,QAAUa,EAAWvJ,MAChCuJ,EAAWf,GAA2C,GAAtCa,EAAYC,OAASI,GACrCH,EAAWR,QAA8B,GAApBQ,EAAWJ,OAChCI,EAAWxC,cAAgB,SAC3BwC,EAAWzC,MAAQ,QACrB,MACA,IAAK,MACHyC,EAAWvJ,MAAQuF,MACnBgE,EAAWJ,OAAkB,GAAT3D,GACpB+D,EAAWf,EAAIa,EAAYC,OAASI,EACpCH,EAAWR,QAA8B,GAApBQ,EAAWJ,OAChCI,EAAWxC,cAAgB,SAC3BwC,EAAWzC,MAAQ,OACrB,MACA,IAAK,MACHyC,EAAWvJ,MAAQuF,IACnBgE,EAAWJ,OAASI,EAAWrC,SAAWqC,EAAWvC,WACrDuC,EAAWb,QAAUa,EAAWvJ,MAChCuJ,EAAWf,GAA2C,GAAtCa,EAAYC,OAASI,GACrCH,EAAWR,QAA8B,GAApBQ,EAAWJ,OAChCI,EAAWxC,cAAgB,SAC3BwC,EAAWzC,MAAQ,QACrB,MACA,IAAK,MACHyC,EAAWvJ,MAAQuF,MACnBgE,EAAWJ,OAAkB,GAAT3D,GACpB+D,EAAWf,EAAIa,EAAYC,OAASI,EACpCH,EAAWR,QAA8B,GAApBQ,EAAWJ,OAChCI,EAAWxC,cAAgB,SAC3BwC,EAAWzC,MAAQ,OACrB,MACA,QACEyC,EAAWvJ,MAAQuF,IACnBgE,EAAWJ,OAASI,EAAWrC,SAAWqC,EAAWvC,WACrDuC,EAAWb,QAA6B,GAAnBa,EAAWvJ,MAChCuJ,EAAWR,QAAUQ,EAAWJ,OAChCI,EAAWd,GAA0B,EAAtBY,EAAYC,OAAcG,EACzCF,EAAWxC,cAAgB,SAG/B,OAAQ8B,EAAO/M,OACb,KAAKR,EACH+N,EAAYhB,OAAS3C,GAAMK,KAC3BwD,EAAW1C,KAAOnB,GAAMK,KAC1B,MACA,KAAKzK,EACH+N,EAAYhB,OAAS3C,GAAMG,IAC3B0D,EAAW1C,KAAOnB,GAAMG,IAC1B,MACA,KAAKvK,EACH+N,EAAYhB,OAAS3C,GAAMI,MAC3ByD,EAAW1C,KAAOnB,GAAMI,MAI5B,IAAM6D,EAAgB,uCACjBlD,GAAWC,MACXD,GAAWW,eAFM,IAGpB/M,KAAK,GAAD,OAAKwO,EAAO5M,UAAZ,YAAyB4M,EAAO3M,WACpC8D,MAA4B,EAArBqJ,EAAYC,SAIfM,EAAyC,GAA5BD,EAAiBzC,SAC9B2C,EAAQhB,EAAO9M,MAAQ8M,EAAO7M,UAAa,cAAC,GAAD,CAAY6M,OAAQA,EAAQJ,GAAiB,GAAdmB,EAAmB3B,KAFlF,QAEuG,KAUxH,OARA0B,EAAiBR,OAASQ,EAAiBzC,SAAWyC,EAAiB3C,WACvE2C,EAAiBjB,QAAmC,GAAzBiB,EAAiB3J,MAC5C2J,EAAiBZ,QAAoC,GAA1BY,EAAiBR,OAExCU,IACFF,EAAiBlB,EAAKqB,KAAgC,GAAbF,GAIzC,qCACE,cAAC,KAAD,eAAYP,IACXQ,EACD,cAAC,GAAD,eAAkBF,IAElB,cAAC,GAAD,eAAkBJ,QAKlBQ,GAAgB,SAAC,GAAc,IAAZnK,EAAW,EAAXA,KACjBoK,EAAc,SAAAV,GAAM,MAAK,CAAEtJ,MAAgB,IAATsJ,EAAcH,OAAiB,IAATG,EAAcZ,QAAkB,GAATY,EAAcP,QAAkB,GAATO,IAE5G,OAAQ1J,GACN,KAAKrE,EACH,OACE,qCACE,cAAC,KAAD,CACE+N,OAAQhD,GACRO,KAAMnB,GAAMO,SAEd,cAAC,GAAD,uCACMQ,GAAWC,MACXD,GAAWQ,cAFjB,IAGE5M,KAAMuF,EAAK4J,cACX3C,KAAMnB,GAAME,OACRoE,EAAY1D,SAIxB,KAAK/K,EACH,OACE,qCACE,cAAC,KAAD,CACE+N,OAAQjD,GACRgC,OAAQ3C,GAAMS,KACdoC,YAAahC,GACb0D,KAAMzD,KAER,cAAC,GAAD,uCACMC,GAAWC,MACXD,GAAWQ,cAFjB,IAGE5M,KAAMuF,EAAK4J,cACX3C,KAAMnB,GAAMS,MACR6D,EAAY3D,SAIxB,KAAK9K,EACH,OACE,qCACE,cAAC,KAAD,CACE+N,OAAQjD,GACRgC,OAAQ3C,GAAMQ,KACdqC,YAAahC,GACb0D,KAAMzD,KAER,cAAC,GAAD,uCACMC,GAAWC,MACXD,GAAWQ,cAFjB,IAGE5M,KAAMuF,EAAK4J,cACX3C,KAAMnB,GAAMQ,MACR8D,EAAY3D,SAIxB,KAAK9K,EACH,OACE,qCACE,cAAC,KAAD,CACE+N,OAAQjD,GACRQ,KAAMnB,GAAMS,OAEd,cAAC,GAAD,uCACMM,GAAWC,MACXD,GAAWQ,cAFjB,IAGE5M,KAAMuF,EAAK4J,cACX3C,KAAMnB,GAAME,OACRoE,EAAY3D,SAIxB,QACE,OAAO,OAIP6D,GAAiB,SAAC,GAAc,IAC9BC,EAAgB,GAEtB,OAHmC,EAAXvK,MAItB,KAAKpE,EACH2O,EAAcC,MAAQ1E,GAAMO,OAC5BkE,EAAc9P,KAAO,SACvB,MACA,KAAKmB,EACH2O,EAAcC,MAAQ1E,GAAMI,MAC5BqE,EAAc9P,KAAO,SACvB,MACA,QACE,OAAO,KAEX,OACE,qCACE,cAAC,KAAD,CACEiP,OAAQjD,GACRgC,OAAQ8B,EAAcC,MACtB7B,YAAahC,GACb0D,KAAMzD,KAER,cAAC,GAAD,2BACMC,GAAWC,MADjB,IAEEC,WAAW,aACXtM,KAAM8P,EAAc9P,KACpBwM,KAAMsD,EAAcC,MACpBlD,SAAUb,OACVrG,MAAOqG,MACP8C,OAAQ9C,MACRqC,QAASrC,GACT0C,QAAS1C,UAMXgE,GAAe,SAAC,GAAgC,IAA9B1J,EAA6B,EAA7BA,SAAUf,EAAmB,EAAnBA,KAAM0K,EAAa,EAAbA,OACtC,OAAQ1K,GACN,KAAKwG,GAAoB,OAAO,cAAC,GAAD,CAAQyC,OAAQyB,EAAQ3J,SAAUA,IAClE,KAAKyF,GAAqB,OAAO,cAAC,GAAD,CAAexG,KAAM0K,IACtD,KAAKlE,GAAsB,OAAO,cAAC,GAAD,CAAgBxG,KAAM0K,MAItDC,GAAgB,SAAC,GAAgB,IAAdC,EAAa,EAAbA,OACjBC,EAAU,GAQhB,OAPIrM,IAAEsM,IAAIF,EAAQ,mBAAqB,GACrCC,EAAQ3Q,KAAR,MAAA2Q,EAAO,YAASD,EAAO5O,QAAQvC,KAAI,SAAAwP,GAAM,MAAI,CAACzC,GAAoByC,QAGhE2B,EAAOlO,SAASmO,EAAQ3Q,KAAK,CAACsM,GAAqBoE,EAAOlO,UAC1DkO,EAAOjO,UAAUkO,EAAQ3Q,KAAK,CAACsM,GAAsBoE,EAAOjO,WAEzDkO,EAAQpR,KAAI,WAAuBkB,GAAO,IAAD,mBAA3BoQ,EAA2B,KAAfL,EAAe,KACxC3J,EAAQ,UAAM8J,EAAQ9P,OAAd,YAAwBJ,GAChCqQ,EAAgB,GACtB,OAAQjK,GACN,IAAK,MAAOiK,EAAcpC,EAAIjD,KAAcqF,EAAcnC,EAAa,IAATjD,GAAe,MAC7E,IAAK,MAAOoF,EAAcpC,EAAY,GAARjD,GAAcqF,EAAcnC,EAAa,GAATjD,GAAe,MAC7E,IAAK,MAAOoF,EAAcpC,EAAY,IAARjD,GAAcqF,EAAcnC,EAAa,IAATjD,GAAe,MAC7E,IAAK,MAAOoF,EAAcpC,EAAIjD,OAAcqF,EAAcnC,EAAa,GAATjD,GAAe,MAC7E,IAAK,MAAOoF,EAAcpC,EAAY,IAARjD,GAAcqF,EAAcnC,EAAa,IAATjD,GAAe,MAC7E,QACEoF,EAAcpC,EAAIjD,IAClBqF,EAAcnC,EAAIjD,GAAS,EAE/B,OACE,cAAC,KAAD,2BAEMoF,GAFN,aAIE,cAAC,GAAD,CACEjK,SAAUA,EACVf,KAAM+K,EACNL,OAAQA,MANL/P,OAaPsQ,GAAe,SAAC,GAAgB,IAAdL,EAAa,EAAbA,OAChBjB,EAAU,uCACX9C,GAAWC,MACXD,GAAWU,cAFA,IAGd9M,KAAMmQ,EAAO9O,OACb8M,EAAGjD,IACHkD,EAAY,GAATjD,GACHxF,MAAOuF,OACPuB,MAAO,SAOT,OAJAyC,EAAWJ,OAA+B,EAAtBI,EAAWrC,SAC/BqC,EAAWb,QAAUa,EAAWvJ,MAAQ,EACxCuJ,EAAWR,QAAUQ,EAAWJ,OAAS,EAEjCqB,EAAO7O,MACb,KAAKP,EACHmO,EAAW1C,KAAOnB,GAAMG,IAC1B,MACA,KAAKzK,EACHmO,EAAW1C,KAAOnB,GAAMK,KAC1B,MACA,QACEwD,EAAW1C,KAAOnB,GAAMS,KAG5B,OAAO,cAAC,KAAD,eAAUoD,KAGbuB,GAAqB,SAAC,GAAD,IAAGN,EAAH,EAAGA,OAAH,OACzB,cAAC,KAAD,CAAOxK,MAAOuF,GAAO4D,OAAQ3D,GAA7B,SACE,eAAC,KAAD,WACGgF,EAAOlO,QAAU,cAAC,GAAD,IAAoB,KACtC,cAAC,GAAD,CAAckO,OAAQA,IACtB,cAAC,GAAD,CAAeA,OAAQA,UAKdO,kBAAKD,IAAoB,SAACE,EAAWC,GAAZ,OAA0B7M,IAAE8M,QAAQ9M,IAAEsM,IAAIM,EAAW,iBAAkB5M,IAAEsM,IAAIO,EAAW,qB,4DCrc1HE,GAAoB,SAAC,GAAsB,IAApBzP,EAAmB,EAAnBA,OAAQkE,EAAW,EAAXA,KAC7B4K,EAASpM,IAAEgN,KAAK3P,EAAS,CAAEC,WAEjC,OAAK8O,EAED5K,IAASsF,GACJ,sBAAM/F,UAAU,aAAhB,SAA8BzD,IAGnCkE,IAASsF,GACJ,qBAAKmG,IAAG,UAAKlH,IAAL,OAAsBzI,EAAtB,QAAoC4P,IAAG,iBAAY5P,GAAUyD,UAAU,eAAeoM,WAAW,IAIhH,cAACC,GAAD,UAAe,cAACC,GAAD,CAAsBjB,OAAQA,MAX3B,MAsDPkB,GAvCI,SAAC,GAAyE,IAAvElB,EAAsE,EAAtEA,OAAsE,IAA9DzK,aAA8D,MAAtD,GAAsD,EAAlD4L,EAAkD,EAAlDA,YAAaC,EAAqC,EAArCA,OAAQC,EAA6B,EAA7BA,aAAiBvE,EAAY,kBACxF,EAA6BwE,cAC3B,iBAAO,CACLlM,KAAM,OACNmM,KAAM,CAAEvB,UACRwB,QAAS,kBAAOJ,GAChBK,QAAS,SAACC,GAAD,MAAc,CACrBC,WAAYD,EAAQC,kBAGxB,CAAC3B,EAAQoB,EAAQtE,EAAM8E,QATzB,mBAAOC,EAAP,KAAkBC,EAAlB,KAYMC,EAAU,CAAC,eAWjB,OAVIZ,GAAaY,EAAQzS,KAAR,kBAAwB6R,IACrCU,EAAUF,YACZI,EAAQzS,KAAK,eAGX8R,GACFW,EAAQzS,KAAK,UAKb,qBACEqF,UAAWoN,EAAQtS,KAAK,KACxB8F,MAAOA,EAAOyM,IAAKF,EACnBG,cAAeZ,GAAgB,KAC/Ba,KAAK,SAJP,SAME,cAAC,GAAD,CACEhR,OAAQ8O,EACR5K,KAAM+L,OCxDVR,GAAoB,SAAC,GAAsB,IAApBvL,EAAmB,EAAnBA,KAAM+M,EAAa,EAAbA,OACjC,OAAI/M,IAASsF,GACJ,KAGLtF,IAASsF,GAEJ,qBAAKmG,IAAG,UAAKlH,GAAL,cAAyBwI,EAAzB,QAAuCrB,IAAI,cAAcnM,UAAU,eAAeoM,WAAW,IAGvG,cAACC,GAAD,KAYMoB,GATQ,SAAC,GAAyC,IAAvCD,EAAsC,EAAtCA,OAAsC,IAA9B5M,aAA8B,MAAtB,GAAsB,EAAlB4L,EAAkB,EAAlBA,YAC1C,OACE,sBAAKxM,UAAS,iDAA4CwM,GAAe5L,MAAOA,EAAhF,UACE,cAAC,GAAD,CAAmBH,KAAM+L,EAAagB,OAAQA,IAC9C,sBAAMxN,UAAU,aAAhB,SAA8BwN,Q,uGCdhCE,GAAoB,SAAC,GAAe,IAAbT,EAAY,EAAZA,MACnBzL,EAAWvC,IAAEsM,IAAIzG,GAAoBmI,GAQ3C,MANc,CACVxL,KAAMxC,IAAEsM,IAAI/J,EAAU,SAAW,KACjCE,IAAKzC,IAAEsM,IAAI/J,EAAU,QAAU,KAC/BuD,OAAQ9F,IAAEsM,IAAI/J,EAAU,WAAa,OA+D9BmM,GAzDE,SAAC,GAUX,IATHV,EASE,EATFA,MASE,IARF5B,cAQE,MARO,KAQP,MAPFuC,kBAOE,MAPW,KAOX,EANFpB,EAME,EANFA,YACAqB,EAKE,EALFA,SACApB,EAIE,EAJFA,OACAqB,EAGE,EAHFA,YACAC,EAEE,EAFFA,kBAGA,GADE,kBACqCC,aAAQ,CAC3CC,OAAQ,OACRC,KAAM,YAAiB,IAAd7C,EAAa,EAAbA,OAAewC,EAASxC,EAAQ4B,IACzCkB,QAAS,mBAAQ1B,GAAUqB,IAC3BhB,QAAS,SAACC,GAAD,MAAc,CACnBqB,OAAQrB,EAAQqB,SAChBD,QAASpB,EAAQoB,eANzB,0BAASC,EAAT,EAASA,OAAQD,EAAjB,EAAiBA,QAAWE,EAA5B,KAUMjB,EAAU,CAAC,qBAYjB,OAXIgB,GACAhB,EAAQzS,KAAKwT,EAAU,WAAa,WAEpC1B,GACAW,EAAQzS,KAAK,UAEbmT,GACAV,EAAQzS,KAAK,eAKb,sBAEIqF,UAAWoN,EAAQtS,KAAK,KACxB8F,MAAO8M,GAAkB,CAAET,UAC3BI,IAAKgB,EACLd,KAAK,SACLD,cAAe,WAAQS,EAAkBd,IAN7C,UAQKW,GAAc,cAAC,GAAD,CAAgBJ,OAAQI,EAAYpB,YAAaA,EAAaS,MAAOA,IACnF5B,GACG,cAAC,GAAD,CACI4B,MAAOA,EACP5B,OAAQA,EACRmB,YAAaA,EACbC,OAAQA,EACRqB,YAAaA,KAGnBA,GAAe,sBAAM9N,UAAU,iBAjB5BiN,I,6ECvBFqB,GA7BM,SAAC,GAOf,IANHC,EAME,EANFA,aACAC,EAKE,EALFA,YACAX,EAIE,EAJFA,SAIE,IAHF7N,iBAGE,MAHU,GAGV,EAFF+N,EAEE,EAFFA,kBACG5F,EACD,kBACF,OACI,6CAAKnI,UAAS,wBAAmBA,IAAiBmI,GAAlD,aACKlJ,IAAEwP,QAAQF,GAAcrU,KAAI,YAAmD,IAAD,mBAAhD+S,EAAgD,YAAvC5B,EAAuC,EAAvCA,OAAQ3F,EAA+B,EAA/BA,GAAI+G,EAA2B,EAA3BA,OAAQqB,EAAmB,EAAnBA,YACxD,OACI,cAAC,GAAD,CAEIb,MAAOA,EACP5B,OAAQA,EACRuC,WAAYlI,EACZ+G,OAAQA,EACRqB,YAAaA,EACbtB,YAAagC,EACbX,SAAUA,EACVE,kBAAmBA,GARdd,U,wCCcdyB,GAxBK,SAAC,GAKd,IAAD,IAJFrJ,eAIE,MAJQ,GAIR,EAHFwI,EAGE,EAHFA,SACAW,EAEE,EAFFA,YAGA,GADE,kBACqCR,aAAQ,CAC3CC,OAAQ,OACRC,KAAM,YAAiB,IAAd7C,EAAa,EAAbA,OAAewC,EAASxC,EAAQ,OAEzCyB,QAAS,SAACC,GAAD,MAAc,CACnBqB,OAAQrB,EAAQqB,SAChBD,QAASpB,EAAQoB,eANzB,0BAA4BE,GAA5B,EAASD,OAAT,EAAiBD,QAAjB,MAUA,OACI,sBAAKnO,UAAU,yBAAyBqN,IAAKgB,EAA7C,UACI,qBAAKzN,MAAO,CAAEC,MAAO,QAArB,SAAgCwE,EAAQ7J,SACvC6J,EAAQnL,KAAI,SAAAmR,GAAM,OAAI,cAAC,GAAD,CAAyBA,OAAQA,EAAQmB,YAAagC,GAArCnD,UCI9CsD,GAAgB,CAClBC,SAAU,WACVC,MAAO,QACPC,YAAa,eAGXC,GAAa,SAAC,GAAgC,IAA9BR,EAA6B,EAA7BA,aAAcS,EAAe,EAAfA,UAChC,EAA8CzQ,mBAAS,CAACoQ,GAAcE,QAAtE,mBAAOI,EAAP,KAAwBC,EAAxB,KAaM1J,EAAUwJ,EAAUxJ,QAAQtL,KAAI,SAACsT,GAAY,IAAD,EAc9C,OAbAA,EAAOnI,QAAUpG,IAAEkQ,WAAF,mBACZR,GAAcC,SAAWpB,EAAOhM,SAASmE,UAD7B,cAEZgJ,GAAcE,MAAQ5P,IAAEmQ,KAAF,sBAAW5B,EAAOhM,SAASmE,UAA3B,YAAwC6H,EAAOhM,SAASoE,UAFlE,cAGZ+I,GAAcG,YAAc7P,IAAEmQ,KAAF,sBAAW5B,EAAOhM,SAASmE,UAA3B,YAAwC6H,EAAOhM,SAASoE,OAAxD,YAAkE4H,EAAOhM,SAASqE,gBAHlG,IAId,SAACwJ,GAOA,OA1Da,SAAChK,GAAa,IAAD,EAC5BiK,EAAU,CACZC,MAAOlK,EAAQ7J,QAGbiB,EAAUwC,IAAEC,MAAMmG,GAASnL,IAAI,WAAWsV,UAAUrU,QAkB1D,OAhBAmU,EAAQ7S,QAAUA,EAAQjB,OAC1B8T,EAAQxS,UAAYmC,IAAEwQ,MAAMhT,EAAS,aACrC6S,EAAQvS,UAAYkC,IAAEwQ,MAAMhT,EAAS,aACrC6S,EAAQI,eAAiBzQ,IAAEwQ,MAAMhT,GAAS,gBAAGK,EAAH,EAAGA,UAAWC,EAAd,EAAcA,UAAd,OAA8BkC,IAAEE,IAAI,CAACrC,EAAWC,OAC1FuS,EAAQ1S,KAAOqC,IAAEwQ,MAAMhT,GAAS,qBAAGG,KAAkB,EAAI,KACzD0S,EAAQzS,UAAYoC,IAAEwQ,MAAMhT,GAAS,qBAAGI,UAA4B,EAAI,KACxEyS,EAAQK,QAAR,mBACKxT,EAAoB8C,IAAEwQ,MAAMhT,GAAS,qBAAGE,QAAsBR,EAAoB,EAAI,MAD3F,cAEKA,EAAqB8C,IAAEwQ,MAAMhT,GAAS,qBAAGE,QAAsBR,EAAqB,EAAI,MAF7F,cAGKA,EAAmB8C,IAAEwQ,MAAMhT,GAAS,qBAAGE,QAAsBR,EAAmB,EAAI,MAHzF,GAMAmT,EAAQM,UAAY3Q,IAAEwQ,MAAMpK,GAAS,qBAAGlI,QAAwB,EAAI,KACpEmS,EAAQO,UAAY5Q,IAAEwQ,MAAMpK,GAAS,qBAAGjI,SAA0B,EAAI,KACtEkS,EAAQQ,UAAY7Q,IAAEwQ,MAAMpK,GAAS,oBAAG5I,QAAH,OAAyC,UAAzC,MAAa,GAAb,GAA8BjB,OAAe,EAAI,KAE/E8T,EAmCQS,CANS9Q,IAAEmQ,KAAKC,GACtBnV,KAAI,SAAC+S,GAEF,OADehO,IAAEgN,KAAK3P,EAAS,CAAEC,OAAQ0C,IAAEsM,IAAIgD,EAAN,UAAuBtB,EAAvB,iBAG5CxN,QAAO,SAAA4L,GAAM,OAAIA,SAGfmC,KAGX,OACI,sBAAKxN,UAAU,oBAAf,UACI,8BACKf,IAAEwP,QAAQE,IAAezU,KAAI,mCAAE4F,EAAF,KAAOkQ,EAAP,YAC1B,sBAAKhQ,UAAU,+BAAf,UACI,uBACIA,UAAU,mBACVS,KAAK,WACLwP,GAAE,yBAAoBnQ,GACtB3E,MAAO6U,EACPE,QAASjB,EAAgBkB,QAAQH,IAAU,EAC3CjP,SAAU,SAACC,IAvCJ,SAACgP,EAAOE,GACnChB,GAAmB,SAACkB,GAAD,OAAgBnR,IAAEC,MAAMyP,IACtC0B,SACA5Q,QAAO,SAAC6Q,GACL,OAAIA,IAAkBN,EAAcE,EAC7BE,EAAWD,QAAQG,IAAkB,KAE/CnV,WAiCmBoV,CAAuBP,EAAOhP,EAAEX,OAAO6P,YAG/C,uBAAOlQ,UAAU,mBAAmBwQ,QAAO,yBAAoB1Q,GAA/D,SAAuEkQ,MAXxBA,QAe3D,qBAAKhQ,UAAU,mBAAf,SACI,wBAAOA,UAAU,wBAAjB,UACI,gCAAO,+BACH,oBAAIyQ,QAAQ,MACZ,oBAAIzQ,UAAU,WAAd,SAAyB,6CACzB,oBAAIA,UAAU,WAAd,SAAyB,+CACzB,oBAAIA,UAAU,WAAd,SAAyB,+CACzB,oBAAIA,UAAU,WAAd,SAAyB,qDACzB,oBAAIA,UAAU,WAAd,SAAyB,uDACzB,oBAAIA,UAAU,WAAd,SAAyB,sDACzB,oBAAIA,UAAU,WAAd,SAAyB,qDACzB,oBAAIA,UAAU,WAAd,SAAyB,uDACzB,oBAAIA,UAAU,WAAd,SAAyB,sDACzB,oBAAIA,UAAU,WAAd,SAAyB,+CACzB,oBAAIA,UAAU,WAAd,SAAyB,+CACzB,oBAAIA,UAAU,WAAd,SAAyB,4DAE7B,gCACKwF,EAAQtL,KAAI,SAACsT,GAAD,OACT,cAAC,WAAD,UACKyB,EAAgB/U,KAAI,SAACwW,EAAaC,GAAd,OACjB,qBAEI3Q,UACI,CACI,YACoB,IAAnB2Q,EAAuB,kBAAoB,GAC3CA,IAAoB1B,EAAgBzT,OAAS,EAAK,iBAAmB,IACxEV,KAAK,KAPf,UAUwB,IAAnB6V,GAAwB,oBAAIC,QAAS3B,EAAgBzT,OAA7B,SAAsCgS,EAAO/H,QACtE,6BAAKiL,IACL,oBAAI1Q,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAajU,SAAW,IACpE,oBAAIuD,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAa5T,WAAa,IACtE,oBAAIkD,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAa3T,WAAa,IACtE,oBAAIiD,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAahB,gBAAkB,IAC3E,oBAAI1P,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAa7T,WAAa,IACtE,oBAAImD,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAa9T,MAAQ,IACjE,oBAAIoD,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAaf,OAAOxT,IAAsB,IACtF,oBAAI6D,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAaf,OAAOxT,IAAuB,IACvF,oBAAI6D,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAaf,OAAOxT,IAAqB,IACrF,oBAAI6D,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAad,WAAa,IACtE,oBAAI5P,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAatT,UAAY,IACrE,oBAAI4C,UAAU,cAAd,SAA6BwN,EAAOnI,QAAQqL,GAAaZ,WAAa,MAtBjEY,OAHFlD,EAAO/H,qBAqC5CoL,GAAc,SAAC,EAAD,OAAUC,EAAV,EAAGC,MAA4BC,EAA/B,EAAwBD,MAAxB,OAA8C9R,IAAE8M,QAAQ+E,EAAUE,IAEvEpF,kBAAKmD,GAAY8B,I,qCC5I1BI,I,2DACF,aAAe,IAAD,8BACV,gBACKC,MAAQ,CAAEC,MAAM,GAErB,EAAKC,gBAAkB,IAEvB,EAAKC,QAAU,EAAKA,QAAQC,KAAb,iBACf,EAAKC,cAAgB,EAAKA,cAAcD,KAAnB,iBACrB,EAAKE,MAAQ,EAAKA,MAAMF,KAAX,iBACb,EAAKG,eAAiB,EAAKA,eAAeH,KAApB,iBATZ,E,qDAYd,WACQrX,KAAKkO,MAAMgJ,MACXlX,KAAKyX,SAAS,CAAEP,MAAM,IAE1BQ,SAASC,iBAAiB,UAAW3X,KAAKsX,iB,gCAG9C,SAAmBT,GACXA,EAASK,OAASlX,KAAKkO,MAAMgJ,MAC7BlX,KAAKoX,QAAQpX,KAAKkO,MAAMgJ,Q,kCAIhC,WACQlX,KAAK4X,mBACLC,aAAa7X,KAAK4X,mBAEtBF,SAASI,oBAAoB,UAAW9X,KAAKsX,iB,qBAGjD,SAAQJ,GAAO,IAAD,OACVlX,KAAKyX,SAAS,CAAEP,OAAMa,eAAe,IACrC/X,KAAK4X,kBAAoBI,YAAW,WAAQ,EAAKP,SAAS,CAAEM,eAAe,MAAY/X,KAAKmX,mB,2BAGhG,SAAclR,IAEJjG,KAAKiX,MAAMC,MAAQlX,KAAKkO,MAAMgJ,QAExB,WADIjR,EAARJ,KACc7F,KAAKuX,W,mBAG/B,YACmC,IAA3BvX,KAAKkO,MAAM+J,aACXjY,KAAKkO,MAAMgK,SAASlY,KAAKkO,MAAMgK,Y,4BAGvC,WACI,MAAmClY,KAAKkO,MAAhCiK,EAAR,EAAQA,OAAQpM,EAAhB,EAAgBA,SAAU8C,EAA1B,EAA0BA,KAC1B,GAAIsJ,EACA,OAAO,qBAAKpS,UAAU,eAAf,SAA+BgG,IAG1C,IAAIqM,EAAYvJ,EAAI,gBAAYA,GAAS,GAEzC,OACI,qBAAK9I,UAAS,uBAAkBqS,GAAhC,SACI,qBAAKrS,UAAU,gBAAf,SACKgG,Q,oBAMjB,WACI,MAA+D/L,KAAKkO,MAApE,IAAQmK,cAAR,aAAuBC,YAAvB,cAAoCH,OAApC,EAA4CpS,kBAA5C,MAAwD,GAAxD,EAEA,IAAK/F,KAAKwX,iBAAkB,OAAO,KAEnC,IAAMe,EAAiBxS,EAAUxC,MAAM,KACvCgV,EAAe7X,KAAK,iBAChB2X,EACAE,EAAe7X,KAAK,gBAEpB6X,EAAe7X,KAAK,gBAEpBV,KAAKiX,MAAMc,eAAeQ,EAAe7X,KAAK,uBAC9CV,KAAKiX,MAAMC,MAAMqB,EAAe7X,KAAK,cAEzC,IAAMyS,EAAU,GAChBA,EAAQzS,KAAK,SAET4X,GAAMnF,EAAQzS,KAAK,QAEnBV,KAAKiX,MAAMC,MAAM/D,EAAQzS,KAAK,QAElC,IAAM8X,EACF,qBAAKzS,UAAWwS,EAAe1X,KAAK,KAApC,SACI,sBACIkF,UAAWoN,EAAQtS,KAAK,KAD5B,UAGKb,KAAKwX,iBACN,qBAAKzR,UAAU,sBAAsBsB,QAASrH,KAAKuX,aAK/D,GAAIc,EAAQ,CACR,IAAMI,EAAaf,SAASgB,eAAe,gBAC3C,OAAKD,EACEE,uBAAaH,EAAcC,GADV,KAI5B,OAAOD,M,GA1GKI,cA8GpB5B,GAAM6B,YAAc,YAA4B,IAAzBX,EAAwB,EAAxBA,QAASY,EAAe,EAAfA,SACtBC,EACF,wBAAQvS,KAAK,SAAST,UAAU,QAAQiT,eAAa,QAAQC,aAAW,QAAQ5R,QAAS6Q,EAAzF,SACI,sBAAMgB,cAAY,OAAlB,oBAGR,OAAIJ,EACO,qBAAK/S,UAAU,wBAAf,SAAwCgT,IAE5CA,GAGX/B,GAAMmC,OAAS,gBAAGpN,EAAH,EAAGA,SAAUmM,EAAb,EAAaA,QAASkB,EAAtB,EAAsBA,MAAtB,OACX,sBAAKrT,UAAU,eAAf,UACKqT,GAAS,oBAAIrT,UAAU,cAAd,SAA6BqT,IACtClB,GAAW,cAAC,GAAMW,YAAP,CAAmBX,QAASA,IACvCnM,MAITiL,GAAMqC,KAAO,gBAAGtN,EAAH,EAAGA,SAAH,IAAahG,iBAAb,MAAyB,GAAzB,SAAkC,qBAAKA,UAAS,qBAAgBA,GAA9B,SAA4CgG,KAC3FiL,GAAMsC,OAAS,gBAAGvN,EAAH,EAAGA,SAAH,OAAkB,qBAAKhG,UAAU,eAAf,SAA+BgG,KAEjDiL,U,iCCrFAuC,GAhDQ,SAAC,GAA2C,IAAzCrC,EAAwC,EAAxCA,KAAMpQ,EAAkC,EAAlCA,SAAUoR,EAAwB,EAAxBA,QAAYhK,EAAY,kBAC9D,EAA0B5J,mBAAS4J,EAAMhN,OAAzC,mBAAOA,EAAP,KAAcsY,EAAd,KAEA3U,qBAAU,WACFqS,GACAsC,EAAStL,EAAMhN,SAEpB,CAACgN,EAAMhN,MAAOgW,IAEjB,IAAMuC,EAAgB,WAA2B,IAA1BC,EAAyB,uDAAVxY,EAC5ByY,GAASD,GAAgB,IAAIjY,QAAQ,gBAAiB,IAAIA,QAAQ,OAAQ,KAChF,OAAOkY,GAGX,OACI,eAAC,GAAD,CACIzC,KAAMA,EAENrI,KAAK,KAHT,UAKI,cAAC,GAAMsK,OAAP,CACIjB,QAASA,EACTkB,MAAM,mBAEV,cAAC,GAAMC,KAAP,UACI,0BACItT,UAAU,eACVe,SAAU,SAACC,GACPyS,EAASzS,EAAEX,OAAOlF,OAAS,KAE/BA,MAAOA,GAAS,GAChBgG,OAAQ,SAACH,GAAQyS,EAASC,EAAc1S,EAAEX,OAAOlF,aAIzD,eAAC,GAAMoY,OAAP,WACI,wBAAQvT,UAAU,4BAA4BsB,QAAS,WAC/CP,GAAUA,EAAS2S,EAAcvY,IACjCgX,GAASA,KAFjB,kBAIA,cAAC,mBAAD,CAAiBjX,KAAMC,EAAvB,SACI,wBAAQ6E,UAAU,+BAAlB,2BCtBd6T,I,OACQ,YADRA,GAEU,aAIVC,GAAsB,SAAC9E,GACzB,IAAM+E,EAAY9U,IAAEkQ,UAAU3M,IAAY,SAACb,EAAGjH,GAC1C,OAAQA,GACJ,KAAK8H,GAAWC,OACZ,MAAO,CAAE4I,OAAQ,GAAIoB,QAAQ,GACjC,QACI,MAAO,CAAEpB,OAAQ,KAAMyC,aAAa,OAgBhD,OAZAkB,EAAUxJ,QAAQwO,SAAQ,SAACxG,GACvBuG,EAAUvG,EAAOhM,SAASkE,IAAIA,GAAK8H,EAAO/H,MAC1CxG,IAAEmQ,KAAF,sBACO5B,EAAOhM,SAASmE,UADvB,YAEO6H,EAAOhM,SAASoE,OAFvB,YAGO4H,EAAOhM,SAASqE,eACpBmO,SAAQ,SAAC/G,UACD8G,EAAU9G,GAAOR,cACjBsH,EAAU9G,GAAOa,kBAIzBiG,GAeLE,GAAiB,SAAC9R,GACpB,IAAMkD,EAAUpG,IAAEC,MAAMiD,GACnBzG,QAAQ,aAAc,IACtB8B,MAAM,OACNiC,SACAvF,IAAI+E,IAAEhE,UACNE,QAEL,OAAO8D,IAAEC,MAAMsD,IACViM,UACAyF,OAAO,GACPha,KAAI,gBAAE+S,EAAF,0BAAc,CAAEA,QAAO5B,OAAQpM,IAAEsM,IAAIlG,EAASpK,SAASgS,EAAMkH,QAAQ,GAAI,MAAQ,SACrF1U,QAAO,gBAAGwN,EAAH,EAAGA,MAAO5B,EAAV,EAAUA,OAAV,OAAuB4B,GAAS5B,KACvClQ,SAGHiZ,GAAe,SAAC5U,GAClB,IAAM6U,EAAc,GACpB,OAAOpV,IAAEC,MAAMM,GACdiP,UACAyF,OAAO,GACPI,YACAnF,WAAU,SAAClC,GASR,OARIA,EAAM5B,QAAUgJ,EAAYlE,QAAQlD,EAAM5B,SAAW,EACrD4B,EAAM5B,OAAS,KAEfgJ,EAAY1Z,KAAKsS,EAAM5B,QAEtB4B,EAAM5B,eAAe4B,EAAM5B,OAC3B4B,EAAMR,eAAeQ,EAAMR,OAC3BQ,EAAMa,oBAAoBb,EAAMa,YAC9Bb,KAEV9R,SAyOUoZ,GA7MI,WAAO,IAAD,EACfC,EAAWC,cACXC,EAAUC,cAEhB,EA7BuB,WACvB,IAAMH,EAAWC,cACXG,EAAQ,IAAIC,gBAAJ,WAAwBL,EAASM,KAAKpZ,QAAQ,SAAU,MAoBtE,OAlBA4G,QAAQsG,IAAI,CAAE4L,WAAUI,UAkBjB,CAAEG,iBAhBS,WACd,IAAMC,EAASJ,EAAMrJ,IAAI,MAAQ0J,OAAOC,aAAaC,QAAQtB,IAC7D,OAAO5U,IAAEsM,IAAInG,GAAY4P,GAAUA,EAAS,KAcrBI,GAAaC,oBAZnB,WACjB,GAAIT,EAAMrJ,IAAI,KAAM,CAChB,IAAM/L,EAAO,GAIb,OAHAyU,GAAeW,EAAMrJ,IAAI,MAAMyI,SAAQ,YAAwB,IAArB/G,EAAoB,EAApBA,MAAO5B,EAAa,EAAbA,OAC7C7L,EAAKyN,GAAS,CAAE5B,aAEb7L,EAGX,OAAO0C,GAAMoT,UAAUL,OAAOC,aAAaC,QAAQtB,KAGMtF,IAOXgH,GAA1CR,EAAR,EAAQA,iBAAkBM,EAA1B,EAA0BA,oBAE1B/S,QAAQsG,IAAI,CAAEmM,mBAAkBM,wBAEhC,MAAkC9W,mBAASwW,GAAoB9P,GAAWE,aAA1E,mBAAOiQ,EAAP,KAAkBI,EAAlB,KACA,EAAwCjX,mBAAS8W,GAAuB,IAAxE,mBAAO9G,EAAP,KAAqBkH,EAArB,KACA,EAA8ClX,mBAASwH,IAAvD,mBAAO2P,EAAP,KAAwBC,EAAxB,KACA,EAAkCpX,mBAAS,IAA3C,mBAAOqX,EAAP,KAAkBC,EAAlB,KACA,EAA8CtX,oBAAS,GAAvD,mBAAOuX,EAAP,KAAwBC,EAAxB,KAEAjX,qBAAU,WACNkX,EAAe5Q,GAAWgQ,IAC1BH,OAAOC,aAAae,QAAQpC,GAAyBuB,KACtD,CAACA,IAEJtW,qBAAU,WA5FO,IAACU,EA6FdqW,GA7FcrW,EA6FY+O,EA5FftP,IAAEC,MAAMM,GAClBiP,UACAhP,QAAO,wCAAuB,IAAIyW,MAAM,YACxChC,OAAO,GACPha,KAAI,qDAAyBmR,QAAU,KAAK/P,SAAS,OACrDH,QACAL,KAAK,KAEIY,QAAQ,YAAa,MAqF/BuZ,OAAOC,aAAae,QAAQpC,GAAuBzR,KAAK+T,UAAU/B,GAAa7F,OAChF,CAACA,IAMJ6H,2BAAgB,WACR5B,EAASM,MACTJ,EAAQhZ,QAAQ,CAAEoZ,KAAM,UAIhC,IAAMuB,GAAoB,EAAApX,IAAEC,MAAM5C,GAC7BpC,IAAI,WACJoc,QAFqB,oBAGfrX,IAAEC,MAAMqP,GACV8B,SACA5Q,OAAO,UACPvF,IAAI,UACJiB,UAEJkD,OACAlD,QAECob,EAAY,SAAChH,GACf,GAAIhB,EAAa9B,QAAU8B,EAAaT,YACpCxL,QAAQsG,IAAI,uBADhB,CAKA,IAAM4N,EAAe,GAEfC,EAAWxX,IAAEiC,MAAMqN,GACzBgB,EAAMyE,SAAQ,YAAwB,IAArB3I,EAAoB,EAApBA,OAAQ4B,EAAY,EAAZA,MACrB,GAAIA,EAAO,CACP,GAAIuJ,EAAarG,QAAQ9E,IAAW,EAAG,OACvC,GAAIoL,EAASxJ,GAAQ,CACjB,GAAIwJ,EAASxJ,GAAOa,YAAa,OACjC,GAAI2I,EAASxJ,GAAOR,OAAQ,QAGpC,GAAKxN,IAAEgN,KAAK3P,EAAS,CAAEC,OAAQ8O,IAA/B,CACA,IAAMqL,EAAiBzX,IAAEsM,IAAIgD,EAAN,UAAuBtB,EAAvB,YACjB0J,EAAY1X,IAAE2X,QAAQrI,EAAc,CAAElD,WAExCsL,IACAF,EAASE,GAAWtL,OAASqL,GAAkB,MAE/CD,EAASxJ,KACTwJ,EAASxJ,GAAO5B,OAASA,GAGzB4B,GACAuJ,EAAa7b,KAAK0Q,OAG1BoK,EAAgBrB,GAAaqC,MAG3B5I,EAAW,SAACxC,EAAQ4B,GAAT,OAAmBsJ,EAAU,CAAC,CAAElL,SAAQ4B,YAUnD+I,EAAiB,WAAqC,IAApCa,EAAmC,uDAA1BzR,GAAWgQ,GAClC0B,EAAchD,GAAoB+C,GAExC5X,IAAEC,MAAMqP,GACPwI,UACA5b,QACA6Y,SAAQ,YAAkC,IAAD,mBAA/B/G,EAA+B,YAAtB5B,EAAsB,EAAtBA,OAAQoB,EAAc,EAAdA,QAClBpB,GAAUoB,KACZqK,EAAY7J,GAAOa,aAAegJ,EAAY7J,GAAOR,SAEzDqK,EAAY7J,GAAO5B,OAASA,EAC5ByL,EAAY7J,GAAOR,OAASA,OAGhCgJ,EAAgBqB,IAGdE,EAAW,kBAAM/X,IAAEC,MAAMqP,GAC1B0I,QAAO,SAAAzX,GAAI,OAAIA,EAAK6L,SAAW7L,EAAKiN,SAAWjN,EAAKsO,eACpDuC,SACAnW,KAAI,kBAAiB,CAAEmR,OAAnB,EAAGA,OAAwB4B,MAAO,SACtC9R,SA4BL,OACI,sBAAK8U,GAAG,cAAcjQ,UAAU,kBAAhC,UACI,qBAAKA,UAAU,aAAf,SACI,eAACkX,EAAA,EAAD,CAAaC,QAASC,KAAtB,UACI,cAAC,GAAD,CACI7I,aAAcA,EACdC,YAAakH,EACb7H,SAAUA,EACVE,kBAjEM,SAACd,GACvBwI,GAAgB,SAAC4B,GACb,IAAMC,EAAerY,IAAEiC,MAAMmW,EAAUpK,IAEvC,OADAqK,EAAa7K,QAAU6K,EAAa7K,OAC7B,2BAAK4K,GAAZ,eAA6BpK,EAAQqK,UAgE7B,cAAC,GAAD,CACIjS,QAASgR,EACTxI,SAAUA,EACVW,YAAakH,SAIzB,qBAAK1V,UAAU,iBAAf,SACI,sBAAKA,UAAU,mBAAf,UACI,uBAAOA,UAAU,UAAUwQ,QAAQ,oBAAnC,uBACA,wBACIxQ,UAAU,qBACViQ,GAAG,oBACHlP,SAAU,SAACC,GAAQwU,EAAaxU,EAAEX,OAAOlF,QACzCA,MAAOia,EAJX,SAMKnW,IAAEoR,OAAOpL,IAAY/K,KAAI,SAAA4F,GAAG,OAAI,wBAAQ3E,MAAO2E,EAAf,SAA+Bb,IAAEsM,IAAInG,GAAN,UAAqBtF,EAArB,WAANA,QAG9D,yBACIE,UAAU,qBACViQ,GAAG,oBACHlP,SAAU,SAACC,GAAQ2U,EAAmB3U,EAAEX,OAAOlF,QAC/CA,MAAOua,EAJX,UAMI,wBAAQva,MAAO4K,GAAf,yBACA,wBAAQ5K,MAAO4K,GAAf,sBAGJ,wBAAQ/F,UAAU,4BAA4BsB,QAAS,WAAQiV,EAlE3D,WAAO,IAAD,EAChBgB,GAAgB,EAAAtY,IAAEC,MAAM5C,GACzBpC,IAAI,WACJoc,QAFiB,oBAGXrX,IAAEC,MAAMqP,GACV8B,SACA5Q,QAAO,SAAAD,GAAI,OAAIA,EAAKiN,QAAUjN,EAAKsO,eACnC5T,IAAI,UACJiB,UAEJqc,UACArc,QAEL,OAAO8D,IAAEC,MAAMqP,GACV0I,QAAO,SAAAzX,GAAI,OAAKA,EAAKiN,SAAWjN,EAAKsO,eACrC2J,OACAvd,KAAI,SAAC+S,EAAO7R,GAAR,MAAe,CAAE6R,QAAO5B,OAAQkM,EAAcnc,IAAM,SACxDD,QAiDgFuc,KAAzE,uBACA,wBAAQ1X,UAAU,4BAA4BsB,QAAS,WAAQiV,EAAUS,MAAzE,mBACA,wBAAQhX,UAAU,4BAA4BsB,QAAS,WAAQyU,GAAmB,IAAlF,6BAGR,qBAAK/V,UAAU,cAAf,SACI,cAAC,GAAD,CACI+Q,MAAO,CAAC6E,EAAWR,GACnB7G,aAAcA,EACdS,UAAW5J,GAAWgQ,IAAc,OAI5C,cAAC,GAAD,CACIjE,OAAQ2E,EACR3D,QAAS,WAAQ4D,GAAmB,IACpChV,SAAU,SAAC5F,IA9DE,SAACgH,GACtB,IAAMwV,EAAQX,IACRY,EAAa3D,GAAe9R,GAClCoU,EAAU,GAAD,mBAAKoB,GAAL,YAAeC,KA4DZC,CAAiB1c,IAErBA,MAAOya,QC5TjBlB,I,OAAUoD,eAmBDC,GAjBA,WACb,OACE,qCACE,qBAAK9H,GAAG,cAAR,SACE,cAAC,IAAD,CAAQyE,QAASA,GAAjB,SACI,eAAC,IAAD,WACE,cAAC,IAAD,CAAOsD,KAAK,YAAYC,UAAW3Z,IACnC,cAAC,IAAD,CAAO0Z,KAAK,mBAAmBC,UAAW1D,KAC1C,cAAC,IAAD,CAAOyD,KAAK,IAAIC,UAAW,kBAAM,cAAC,IAAD,CAAUC,GAAG,wBAItD,qBAAKjI,GAAG,qBCnBdkI,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,GAAD,MAEF1G,SAASgB,eAAe,W","file":"static/js/main.a999fe8b.chunk.js","sourcesContent":["/* --\n\nclass simulator {\n    constructor(...dice) {\n        this.dice = dice;\n    }\n\n    trialRound() {\n        let hits = 0;\n        for (const hitValue of this.dice) {\n            const rollValue = Math.floor(Math.random() * 10) + 1;\n            if (rollValue >= hitValue) hits += 1;\n        }\n        return hits;\n    }\n\n    get results() {\n        if (!this._results) {\n            this.trials();\n        }\n        if (this.textOutput) {\n            const out = [];\n            for (const k in this._results) {\n                out.push(\n                    `${k}: ${((this._results[k] / this._trials) * 100).toFixed(1)}%`\n                );\n            }\n            return out.join(\"\\n\");\n        }\n        return this._results;\n    }\n\n    get cumulative() {\n        if (!this._cumulative) {\n            this.trials();\n        }\n        if (this.textOutput) {\n            const out = [];\n            for (const k in this._cumulative) {\n                out.push(\n                    `>= ${k}: ${((this._cumulative[k] / this._trials) * 100).toFixed(1)}%`\n                );\n            }\n            return out.join(\"\\n\");\n        }\n        return this._cumulative;\n    }\n\n    format(text = true) {\n        this.textOutput = text;\n        return this;\n    }\n\n    trials(nTrials = 10000) {\n        this._results = {};\n        this._cumulative = {};\n        this._trials = nTrials;\n\n        for (let i = 0; i <= this.dice.length; i += 1) {\n            this._results[i.toString(10)] = 0;\n        }\n\n        for (let n = 0; n < nTrials; n += 1) {\n            const hits = this.trialRound();\n\n            this._results[hits.toString(10)] += 1;\n        }\n\n        for (let i = this.dice.length; i >= 0; i -= 1) {\n            this._cumulative[i.toString(10)] = this._results[i.toString(10)];\n            if (this._cumulative[(i + 1).toString(10)]) {\n                this._cumulative[i.toString(10)] += this._cumulative[\n                    (i + 1).toString(10)\n                ];\n            }\n        }\n\n        return this;\n    }\n}\n\n-- */\n\nclass calculator {\n    constructor(...dice) {\n        this.dice = dice.map((input) => {\n            let dieValue = parseFloat(input, 10);\n            if (dieValue === 0) {\n                dieValue = 10;\n            }\n            return dieValue;\n        });\n    }\n    get results() {\n        if (!this._results) {\n            this.calculate();\n        }\n        if (this.textOutput) {\n            const out = [];\n            for (const k in this._results) {\n                out.push(`${k}: ${Math.round(this._results[k] * 100)}%`);\n            }\n            return out.join(\"\\n\");\n        }\n        return this._results;\n    }\n    get cumulative() {\n        if (!this._cumulative) {\n            this.calculate();\n        }\n        if (this.textOutput) {\n            const out = [];\n            for (const k in this._cumulative) {\n                out.push(`>= ${k}: ${Math.round(this._cumulative[k] * 100)}%`);\n            }\n            return out.join(\"\\n\");\n        }\n        return this._cumulative;\n    }\n    get average() {\n      let avg = 0;\n      for (const k in this._results) {\n        avg += parseInt(k, 10) * this._results[k];\n      }\n\n      return avg;\n    }\n\n    format(text = true) {\n        this.textOutput = text;\n        return this;\n    }\n    calculate() {\n        this._results = {};\n        this._cumulative = {};\n\n        const diceP = this.dice.map((value) => (11 - value) / 10);\n        for (let i = 0; i < 2 ** this.dice.length; i += 1) {\n            const outcome = i.toString(2).padStart(this.dice.length, \"0\");\n            const hits = outcome.replace(/0/g, \"\").length;\n            const outcomeP = this.dice.reduce((accumulator, hitValue, dieIndex) => {\n                const p =\n                    outcome[dieIndex] === \"1\"\n                        ? (11 - hitValue) / 10\n                        : 1 - (11 - hitValue) / 10;\n                return accumulator * p;\n            }, 1);\n\n            if (!this._results[hits.toString(10)]) {\n                this._results[hits.toString(10)] = 0;\n            }\n            this._results[hits.toString(10)] += outcomeP;\n        }\n\n        for (let i = this.dice.length; i >= 0; i -= 1) {\n            this._cumulative[i.toString(10)] = this._results[i.toString(10)];\n            if (this._cumulative[(i + 1).toString(10)]) {\n                this._cumulative[i.toString(10)] += this._cumulative[\n                    (i + 1).toString(10)\n                ];\n            } else {\n                this._cumulative[i.toString(10)] = this._results[i.toString(10)];\n            }\n        }\n\n        return this;\n    }\n}\n\nexport { calculator };\n","const URL = {\n    ASSETS_BUCKET: 'https://s3-ap-southeast-2.amazonaws.com/com.basicallyfine.public-assets/'\n};\n\nconst GAME_COLOURS = {\n    WHITE: '#FFFFFF',\n    WHITE_2: '#828282',\n    BLUE: '#1B91FF',\n    BLUE_2: '#00529C',\n    GREEN: '#00BE4C',\n    GREEN_2: '#006328',\n    YELLOW: '#FFE600',\n    YELLOW_2: '#837704',\n    ORANGE: '#FF9922',\n    ORANGE_2: '#835804',\n    RED: '#FF4A31',\n    RED_2: '#973C30',\n    PINK: '#FF5FDC',\n    PINK_2: '#AB009A',\n    PURPLE: '#A107FF',\n    PURPLE_2: '#6500B4',\n};\n\nconst FACTIONS = [\n    // BASE GAME\n    { code: 'AR', name: 'The Arborec', },\n    { code: 'BL', name: 'The Barony of Letnev', },\n    { code: 'CS', name: 'The Clan of Saar', },\n    { code: 'EM', name: 'The Embers of Muaat', },\n    { code: 'EH', name: 'The Emirates of Hacan', },\n    { code: 'EP', name: 'The Empyrean', },\n    { code: 'FS', name: 'The Federation of Sol', },\n    { code: 'GC', name: 'The Ghosts of Creuss', },\n    { code: 'LM', name: 'The L1Z1X Mindnet', },\n    { code: 'MC', name: 'The Mentak Coalition', },\n    { code: 'NC', name: 'The Naalu Collective', },\n    { code: 'NV', name: 'The Nekro Virus', },\n    { code: 'SN', name: 'Sardakk Norr', },\n    { code: 'UJ', name: 'The Universities of Jol-Nar', },\n    { code: 'WN', name: 'The Winnu', },\n    { code: 'XK', name: 'The Xxcha Kingdom', },\n    { code: 'YB', name: 'The Yin Brotherhood', },\n    { code: 'YT', name: 'The Yssaril Tribes', },\n    // POK\n    { code: 'AF', name: 'The Argent Flight', pok: true },\n    { code: 'MG', name: 'The Mahact Gene-Sorcerers', pok: true },\n    { code: 'NR', name: 'The Naaz-Rokha Alliance', pok: true },\n    { code: 'NM', name: 'The Nomad', pok: true },\n    { code: 'TU', name: 'The Titans of Ul', pok: true },\n    { code: 'VR', name: 'The VuilRaith Cabal', pok: true },\n];\n\nconst SYSTEM_TILE_BACK = {\n    BLUE: 'BLUE SYSTEM',\n    RED: 'RED SYSTEM',\n    HS: 'HOME SYSTEM',\n    SPECIAL: 'SPECIAL',\n};\n\nconst TECH_COLOR = {\n    RED: 'Warfare',\n    BLUE: 'Propulsion',\n    GREEN: 'Biotic',\n    YELLOW: 'Cybernetic'\n};\n\nconst PLANET_TRAIT = {\n    BLUE: 'Cultural',\n    RED: 'Hazardous',\n    GREEN: 'Industrial'\n};\n\nconst ANOMALY = {\n    SUPERNOVA: 'Supernova',\n    ASTEROID_FIELD: 'Asteroid Field',\n    NEBULA: 'Nebula',\n    GRAV_RIFT: 'Gravity Rift'\n};\n\nconst WORMHOLE = {\n    A: ' Wormhole',\n    B: ' Wormhole'\n};\n\nconst SYSTEMS = [\n    {\n        number: 18,\n        back: SYSTEM_TILE_BACK.SPECIAL,\n        planets: [\n            { name: 'Mecatol Rex', trait: null, tech: null, legendary: false, resources: 1, influence: 6, mecatol: true }\n        ]\n    },\n    {\n        number: 61,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Ang', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.RED, legendary: false, resources: 2, influence: 0 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 22,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'TarMann', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.GREEN, legendary: false, resources: 1, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 43,\n        back: SYSTEM_TILE_BACK.RED,\n        anomaly: ANOMALY.SUPERNOVA,\n        planets: []\n    },\n    {\n        number: 64,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        wormhole: WORMHOLE.B,\n        planets: [\n            { name: 'Atlas', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 3, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 79,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        anomaly: ANOMALY.ASTEROID_FIELD,\n        wormhole: WORMHOLE.A,\n        planets: []\n    },\n    {\n        number: 19,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Wellon', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.YELLOW, legendary: false, resources: 1, influence: 2 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 34,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Centauri', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 3 },\n            { name: 'Gral', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.BLUE, legendary: false, resources: 1, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 75,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Ashtroth', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 0 },\n            { name: 'Abaddon', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 0 },\n            { name: 'Loki', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 2 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 69,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Accoen', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 3 },\n            { name: 'Jeol Ir', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 3 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 20,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Vefut II', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 2 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 59,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Archon Vail', trait: PLANET_TRAIT.RED, tech: TECH_COLOR.BLUE, legendary: false, resources: 1, influence: 3 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 73,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Cealdri', trait: PLANET_TRAIT.BLUE, tech: TECH_COLOR.YELLOW, legendary: false, resources: 0, influence: 2 },\n            { name: 'Xanhact', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 0, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 66,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Hopes End', trait: PLANET_TRAIT.RED, tech: null, legendary: true, resources: 3, influence: 0 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 70,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Kraag', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 1 },\n            { name: 'Siig', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 0, influence: 2 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 37,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Arinam', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 1, influence: 2 },\n            { name: 'Meer', trait: PLANET_TRAIT.RED, tech: TECH_COLOR.RED, legendary: false, resources: 0, influence: 4 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 27,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'New Albion', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.GREEN, legendary: false, resources: 1, influence: 1 },\n            { name: 'Starpoint', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 3, influence: 1 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 42,\n        back: SYSTEM_TILE_BACK.RED,\n        anomaly: ANOMALY.NEBULA,\n        planets: []\n    },\n    {\n        number: 78,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        planets: []\n    },\n    {\n        number: 50,\n        back: SYSTEM_TILE_BACK.RED,\n        planets: []\n    },\n    {\n        number: 49,\n        back: SYSTEM_TILE_BACK.RED,\n        planets: []\n    },\n    {\n        number: 76,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Rigel I', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 0, influence: 1 },\n            { name: 'Rigel II', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 1, influence: 2 },\n            { name: 'Rigel III', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.GREEN, legendary: false, resources: 1, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 60,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Perimeter', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 24,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Mehar Xull', trait: PLANET_TRAIT.RED, tech: TECH_COLOR.RED, legendary: false, resources: 1, influence: 3 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 31,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Lazar', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.YELLOW, legendary: false, resources: 1, influence: 0 },\n            { name: 'Sakulag', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 32,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Dal Bootha', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 0, influence: 2 },\n            { name: 'Xxehan', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 36,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Arnor', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 1 },\n            { name: 'Lor', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 1, influence: 2 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 71,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Alio Prima', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 1 },\n            { name: 'Bakal', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 3, influence: 2 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 80,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        anomaly: ANOMALY.SUPERNOVA,\n        planets: []\n    },\n    {\n        number: 38,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Abyz', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 3, influence: 0 },\n            { name: 'Fria', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 0 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 74,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Vega Major', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 2, influence: 1 },\n            { name: 'Vega Minor', trait: PLANET_TRAIT.BLUE, tech: TECH_COLOR.BLUE, legendary: false, resources: 1, influence: 2 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 63,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Vorhal', trait: PLANET_TRAIT.BLUE, tech: TECH_COLOR.GREEN, legendary: false, resources: 0, influence: 2 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 23,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Saudor', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 2 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 41,\n        back: SYSTEM_TILE_BACK.RED,\n        anomaly: ANOMALY.GRAV_RIFT,\n        planets: []\n    },\n    {\n        number: 72,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Lisis', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 2, influence: 2 },\n            { name: 'Velnor', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.RED, legendary: false, resources: 2, influence: 1 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 29,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Qucenn', trait: PLANET_TRAIT.GREEN, tech: null, legendary: false, resources: 1, influence: 2 },\n            { name: 'Rarron', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 0, influence: 3 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 48,\n        back: SYSTEM_TILE_BACK.RED,\n        planets: []\n    },\n    {\n        number: 28,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Tequran', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 0 },\n            { name: 'Torkan', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 0, influence: 3 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 47,\n        back: SYSTEM_TILE_BACK.RED,\n        planets: []\n    },\n    {\n        number: 40,\n        back: SYSTEM_TILE_BACK.RED,\n        wormhole: WORMHOLE.B,\n        planets: []\n    },\n    {\n        number: 68,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        anomaly: ANOMALY.NEBULA,\n        planets: [\n            { name: 'Everra', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 3, influence: 1 }\n        ]\n    },\n    {\n        number: 39,\n        back: SYSTEM_TILE_BACK.RED,\n        wormhole: WORMHOLE.A,\n        planets: []\n    },\n    {\n        number: 21,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Thibah', trait: PLANET_TRAIT.GREEN, tech: TECH_COLOR.BLUE, legendary: false, resources: 1, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 26,\n        back: SYSTEM_TILE_BACK.BLUE,\n        wormhole: WORMHOLE.A,\n        planets: [\n            { name: 'Lodor', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 3, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 44,\n        back: SYSTEM_TILE_BACK.RED,\n        anomaly: ANOMALY.ASTEROID_FIELD,\n        planets: []\n    },\n    {\n        number: 46,\n        back: SYSTEM_TILE_BACK.RED,\n        planets: []\n    },\n    {\n        number: 65,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Primor', trait: PLANET_TRAIT.BLUE, tech: null, legendary: true, resources: 2, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 45,\n        back: SYSTEM_TILE_BACK.RED,\n        anomaly: ANOMALY.ASTEROID_FIELD,\n        planets: []\n    },\n    {\n        number: 25,\n        back: SYSTEM_TILE_BACK.BLUE,\n        wormhole: WORMHOLE.B,\n        planets: [\n            { name: 'Quann', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 2, influence: 1 }\n        ],\n        _vm_tier: 3\n    },\n    {\n        number: 77,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        planets: []\n    },\n    {\n        number: 35,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Bereg', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 3, influence: 1 },\n            { name: 'Lirta IV', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 3 }\n        ],\n        _vm_tier: 1\n    },\n    {\n        number: 30,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Mellon', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 0, influence: 2 },\n            { name: 'Zohbat', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 3, influence: 1 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 67,\n        back: SYSTEM_TILE_BACK.RED,\n        pok: true,\n        anomaly: ANOMALY.GRAV_RIFT,\n        planets: [\n            { name: 'Cormund', trait: PLANET_TRAIT.RED, tech: null, legendary: false, resources: 2, influence: 0 }\n        ]\n    },\n    {\n        number: 33,\n        back: SYSTEM_TILE_BACK.BLUE,\n        planets: [\n            { name: 'Corneeq', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 1, influence: 2 },\n            { name: 'Resculon', trait: PLANET_TRAIT.BLUE, tech: null, legendary: false, resources: 2, influence: 0 }\n        ],\n        _vm_tier: 2\n    },\n    {\n        number: 62,\n        back: SYSTEM_TILE_BACK.BLUE,\n        pok: true,\n        planets: [\n            { name: 'Sem-Lore', trait: PLANET_TRAIT.BLUE, tech: TECH_COLOR.YELLOW, legendary: false, resources: 3, influence: 2 }\n        ],\n        _vm_tier: 2\n    }\n];\n\nexport {\n    URL,\n    GAME_COLOURS,\n    FACTIONS,\n    SYSTEM_TILE_BACK,\n    TECH_COLOR,\n    PLANET_TRAIT,\n    ANOMALY,\n    WORMHOLE,\n    SYSTEMS,\n};\n","import React, { useState, useEffect, useMemo } from 'react';\nimport _ from 'lodash';\n\n// import { Chart, curveLinear } from 'react-charts';\nimport { ResponsiveLine } from '@nivo/line';\n\nimport { calculator } from '../lib/rolling-calculator';\nimport { GAME_COLOURS } from '../lib/constants';\n\nimport \"../styles/components/dice-table.css\";\n\nconst RESULT_MODE = {\n  AT_LEAST: 'AT_LEAST',\n  EXACT: 'EXACT',\n};\n\nconst _calcs = {};\nfunction getCalculation(dice) {\n  if (!_calcs[dice]) {\n    _calcs[dice] = new calculator(...dice.split('')).calculate();\n  }\n  return _calcs[dice];\n}\n\nfunction formatPercent(float) {\n  if (float === undefined) return '-';\n  let rounded = Math.round(float * 100);\n  if (rounded === 100) {\n    if (float < 1) {\n      rounded = '>99';\n    }\n    if (float > 1) {\n      rounded = '100';\n    }\n  }\n  return `${rounded}%`;\n}\n\nfunction interpolateColours(colour0, colour1, p) {\n  const colourP = colour0.map((channel0, i) => channel0 + ((colour1[i] - channel0) * p));\n  return `rgba(${colourP.join(',')})`;\n}\n\nfunction rowKey(seed) {\n  return (Date.now() + Math.random() + seed).toString();\n}\n\n// const summariseDice = inputString => _.chain(inputString.split(''))\n//   .groupBy()\n//   .toPairs()\n//   .map(([groupValue, group]) => group.length === 1 ? groupValue : `${groupValue}${group.length}`)\n//   .value()\n//   .join(',\\u2009');\nconst summariseDice = inputString => inputString.split('').sort().join('').replace(/([0-9])(?!\\1+)/g, '$& ').replace(/[^\\d]+$/, '');\n\nconst ResultsChart = ({ data, colours = [], ...props } = {}) => (\n  <ResponsiveLine\n    data={data}\n    curve=\"linear\"\n    animate={false}\n    // enablePoints={false}\n    lineWidth={2}\n    pointSize={5}\n    // pointSymbol={({ size, color }) => (\n    //     <svg width={size} height={size} viewBox=\"8 8 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    //         <path d=\"M0 13.261L5.23729 8L0 2.73904L2.79661 0L8 5.22756L13.2034 0L16 2.73904L10.7627 8L16 13.261L13.2034 16L8 10.7724L2.79661 16L0 13.261Z\" fill={color} />\n    //     </svg>\n    // )}\n    // pointColor={{ from: 'seriesColor' }}\n    xScale={{\n      type: 'point',\n      min: 1,\n      max: 'auto',\n    }}\n    yScale={{\n      type: 'linear',\n      min: 0,\n      max: 1,\n    }}\n    axisLeft={{\n      format: '.0%'\n    }}\n    margin={{ top: 0, left: 0, bottom: 0, right: 0 }}\n    colors={colours}\n  // axisBottom={{\n  //     legend: 'linear scale',\n  //     // legendOffset: -12,\n  // }}\n  />\n);\n\nconst DiceInput = ({ onUpdate, onRemove, value, colour }) => {\n  return (\n    <div className=\"btn-toolbar\">\n      <input type=\"tel\" className=\"form-control\" />\n    </div>\n  )\n};\n\nconst DiceTable = () => {\n  const [resultMode, setResultMode] = useState(RESULT_MODE.AT_LEAST);\n  const [inputs, setInputs] = useState([]);\n  const [focus, setFocus] = useState(null);\n\n  // EXAMPLE CONTENT\n  useEffect(() => {\n      setInputs([\n        // '',\n        // '1',\n        // '22',\n        // '333',\n        // '4444',\n        // '55555',\n        // '666666',\n        // '8888',\n        // '333',\n        // '99999',\n      ]);\n  }, []);\n\n  const rows = [];\n\n  const toggleResultMode = (e) => {\n    e.preventDefault();\n    if (resultMode === RESULT_MODE.AT_LEAST) {\n      setResultMode(RESULT_MODE.EXACT);\n    } else {\n      setResultMode(RESULT_MODE.AT_LEAST);\n    }\n  }\n\n  const resultModeLabel = resultMode === RESULT_MODE.EXACT ? 'exactly' : 'at least';\n\n  const maxHits = _.chain(inputs).map('length').max().value();\n  const valueRange = { min: Infinity, max: -Infinity };\n  const headerCols = [];\n\n  const data = _.chain(inputs).filter().uniqBy(summariseDice).map((dice, inputIndex) => {\n    const result = getCalculation(dice)[resultMode === RESULT_MODE.EXACT ? 'results' : 'cumulative'];\n    const cols = [];\n    for (let i = (resultMode === RESULT_MODE.EXACT ? 0 : 1); i <= maxHits; i += 1) {\n      const value = result[i.toString(10)];\n      if (value > valueRange.max) valueRange.max = value;\n      if (value < valueRange.min) valueRange.min = value;\n      cols.push(value);\n\n      if (inputIndex === 0) {\n        headerCols.push(i);\n      }\n    }\n    return { key: inputIndex, dice, cols, average: getCalculation(dice).average };\n  }).value();\n\n  // if (inputs.filter(({ dice }) => dice).length > 0) {\n  //   data.push({ dice: '', cols: headerCols.map(() => undefined) });\n  // } else {\n  //   headerCols.push(1);\n  //   data.push({ dice: '', cols: [undefined] });\n  // }\n\n  return (\n    <div className=\"container dice-table my-2\">\n      <h2>Dice probability calculator</h2>\n      <p>Enter combat values below to see the probability of producing different numbers of hits.</p>\n\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          const focused = event.target.querySelector('input:focus');\n          if (focused) focused.blur();\n          setInputs(inputs.filter(dice => !!dice.replace(/[^\\d]/g, '')));\n        }}\n        className=\"d-flex flex-wrap mt-2 mb-2\"\n      >\n        {inputs.map((dice, index) => (\n          <div key={index} className=\"dice-input input-group input-group-sm flex-nowrap flex-grow-0 flex-shrink-1 mb-0-5 mr-0-5 w-auto\">\n            <input\n              type=\"text\"\n              inputMode=\"numeric\"\n              className=\"form-control flex-grow-0 flex-shrink-0\"\n              value={dice}\n              placeholder=\"...\"\n              style={{ width: `${(Math.max(3, dice.length) * 0.6) + 1.35}em` }}\n              autoFocus={index === focus}\n              onChange={(e) => {\n                const updateInputs = _.clone(inputs);\n                updateInputs[index] = e.target.value.replace(/[^\\d]/g, '');\n                setInputs(updateInputs);\n              }}\n              onBlur={() => { setFocus(null); }}\n              onFocus={() => { setFocus(index); }}\n            />\n            <div className=\"input-group-append\">\n              <button\n                className=\"btn btn-sm btn-outline-dark\"\n                type=\"button\"\n                tabIndex=\"-1\"\n                onClick={() => {\n                  const updateInputs = _.clone(inputs);\n                  updateInputs.splice(index, 1);\n                  setInputs(updateInputs);\n                }}\n              >\n                &times;\n                </button>\n            </div>\n          </div>\n        ))}\n        <button\n          className=\"btn btn-sm btn-secondary mb-0-5\"\n          type=\"button\"\n          onClick={() => {\n            const updateInputs = _.clone(inputs);\n            updateInputs.push('');\n            setInputs(updateInputs);\n            setFocus(updateInputs.length - 1);\n          }}\n        >\n          + Add values\n          </button>\n        <input type=\"submit\" style={{ position: 'fixed', left: '100%', top: '-100%' }} />\n      </form>\n      {focus !== null && inputs.filter(v => v).length === 0 && (\n        <p className=\"mt-n2 text-muted\">\n          <small>Combat values, eg \"<u>688</u>\". Enter <u>0</u> for 10.</small>\n        </p>\n      )}\n\n      {data.length > 0 ? (\n        <div className=\"results-table\">\n          <p><strong>Probability of <a href=\"#\" onClick={toggleResultMode}>{resultModeLabel}</a> X hits</strong></p>\n          <div className=\"table-responsive\">\n            <table className=\"table\">\n              <thead>\n                <tr>\n                  <th scope=\"col\" />\n                  {headerCols.map(hits => <th scope=\"col\" className=\"text-center\" key={hits}>{hits}</th>)}\n                  <th>Avg. hits</th>\n                </tr>\n              </thead>\n              <tbody>\n                {data.map(({ dice, cols, average }, rowIndex) => (\n                  <tr key={summariseDice(dice)}>\n                    <th scope=\"col\">{summariseDice(dice)}</th>\n                    {cols.map((value, colIndex) => <td key={colIndex} className=\"text-center\" style={{ backgroundColor: typeof value === 'number' ? interpolateColours([20, 20, 50], [255, 40, 220], (value - valueRange.min) / (valueRange.max - valueRange.min)) : 'transparent' }}>{formatPercent(value)}</td>)}\n                    <td className=\"text-right\">{(Math.round(average * 10) / 10).toFixed(1)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nexport default DiceTable;\n","const utils = {};\n\nutils.parseJSON = (string) => {\n    try {\n        return JSON.parse(string);\n    } catch (e) {\n        console.error(e);\n        return undefined;\n    }\n}\n\nexport default utils;","import { URL } from '../../lib/constants';\n\nconst MAP_PLACES = {\n    MAP_00: 'MAP_00',\n    MAP_01: 'MAP_01',\n    MAP_02: 'MAP_02',\n    MAP_03: 'MAP_03',\n    MAP_04: 'MAP_04',\n    MAP_05: 'MAP_05',\n    MAP_06: 'MAP_06',\n    MAP_07: 'MAP_07',\n    MAP_08: 'MAP_08',\n    MAP_09: 'MAP_09',\n    MAP_10: 'MAP_10',\n    MAP_11: 'MAP_11',\n    MAP_12: 'MAP_12',\n    MAP_13: 'MAP_13',\n    MAP_14: 'MAP_14',\n    MAP_15: 'MAP_15',\n    MAP_16: 'MAP_16',\n    MAP_17: 'MAP_17',\n    MAP_18: 'MAP_18',\n    MAP_19: 'MAP_19',\n    MAP_20: 'MAP_20',\n    MAP_21: 'MAP_21',\n    MAP_22: 'MAP_22',\n    MAP_23: 'MAP_23',\n    MAP_24: 'MAP_24',\n    MAP_25: 'MAP_25',\n    MAP_26: 'MAP_26',\n    MAP_27: 'MAP_27',\n    MAP_28: 'MAP_28',\n    MAP_29: 'MAP_29',\n    MAP_30: 'MAP_30',\n    MAP_31: 'MAP_31',\n    MAP_32: 'MAP_32',\n    MAP_33: 'MAP_33',\n    MAP_34: 'MAP_34',\n    MAP_35: 'MAP_35',\n    MAP_36: 'MAP_36'\n};\n\nconst MAP_PLACE_POSITION = {\n    MAP_00: { left: '50.0%', top: '50.0%', zIndex: 199 },\n    MAP_01: { left: '50.0%', top: '35.7%', zIndex: 198 },\n    MAP_02: { left: '63.6%', top: '42.9%', zIndex: 197 },\n    MAP_03: { left: '63.6%', top: '57.1%', zIndex: 196 },\n    MAP_04: { left: '50.0%', top: '64.3%', zIndex: 195 },\n    MAP_05: { left: '36.4%', top: '57.1%', zIndex: 194 },\n    MAP_06: { left: '36.4%', top: '42.9%', zIndex: 193 },\n    MAP_07: { left: '50.0%', top: '21.4%', zIndex: 192 },\n    MAP_08: { left: '63.6%', top: '28.6%', zIndex: 191 },\n    MAP_09: { left: '77.3%', top: '35.7%', zIndex: 190 },\n    MAP_10: { left: '77.3%', top: '50.0%', zIndex: 189 },\n    MAP_11: { left: '77.3%', top: '64.3%', zIndex: 188 },\n    MAP_12: { left: '63.6%', top: '71.4%', zIndex: 187 },\n    MAP_13: { left: '50.0%', top: '78.6%', zIndex: 186 },\n    MAP_14: { left: '36.4%', top: '71.4%', zIndex: 185 },\n    MAP_15: { left: '22.7%', top: '64.3%', zIndex: 184 },\n    MAP_16: { left: '22.7%', top: '50.0%', zIndex: 183 },\n    MAP_17: { left: '22.7%', top: '35.7%', zIndex: 182 },\n    MAP_18: { left: '36.4%', top: '28.6%', zIndex: 181 },\n    MAP_19: { left: '50.0%', top: '7.1%', zIndex: 180 },\n    MAP_20: { left: '63.6%', top: '14.3%', zIndex: 179 },\n    MAP_21: { left: '77.3%', top: '21.4%', zIndex: 178 },\n    MAP_22: { left: '90.9%', top: '28.6%', zIndex: 177 },\n    MAP_23: { left: '90.9%', top: '42.9%', zIndex: 176 },\n    MAP_24: { left: '90.9%', top: '57.1%', zIndex: 175 },\n    MAP_25: { left: '90.9%', top: '71.4%', zIndex: 174 },\n    MAP_26: { left: '77.3%', top: '78.6%', zIndex: 173 },\n    MAP_27: { left: '63.6%', top: '85.7%', zIndex: 172 },\n    MAP_28: { left: '50.0%', top: '92.9%', zIndex: 171 },\n    MAP_29: { left: '36.4%', top: '85.7%', zIndex: 170 },\n    MAP_30: { left: '22.7%', top: '78.6%', zIndex: 169 },\n    MAP_31: { left: '9.1%', top: '71.4%', zIndex: 168 },\n    MAP_32: { left: '9.1%', top: '57.1%', zIndex: 167 },\n    MAP_33: { left: '9.1%', top: '42.9%', zIndex: 166 },\n    MAP_34: { left: '9.1%', top: '28.6%', zIndex: 165 },\n    MAP_35: { left: '22.7%', top: '21.4%', zIndex: 164 },\n    MAP_36: { left: '36.4%', top: '14.3%', zIndex: 163 },\n};\n\nconst SYSTEM_PNG_URL = `${URL.ASSETS_BUCKET}ti4/map/systems/png/`;\n\nconst MAP_OPTION = {\n    THREE_PLAYER: 'P3',\n    FOUR_PLAYER: 'P4',\n    // SIX_PLAYER: 'SIX_PLAYER',\n};\n\nconst MAP_CONFIG = {\n    [MAP_OPTION.THREE_PLAYER]: {\n        name: 'Three player',\n        systems: {\n            blue: 18,\n            red: 6,\n        },\n        players: [\n            {\n                label: 'A',\n                position: {\n                    hs: MAP_PLACES.MAP_34,\n                    adjacent: [MAP_PLACES.MAP_35, MAP_PLACES.MAP_17, MAP_PLACES.MAP_33],\n                    slice: [MAP_PLACES.MAP_35, MAP_PLACES.MAP_17, MAP_PLACES.MAP_33, MAP_PLACES.MAP_18, MAP_PLACES.MAP_06, MAP_PLACES.MAP_16],\n                    equidistant: [MAP_PLACES.MAP_07, MAP_PLACES.MAP_01, MAP_PLACES.MAP_05, MAP_PLACES.MAP_15]\n                }\n            },\n            {\n                label: 'B',\n                position: {\n                    hs: MAP_PLACES.MAP_22,\n                    adjacent: [MAP_PLACES.MAP_21, MAP_PLACES.MAP_09, MAP_PLACES.MAP_23],\n                    slice: [MAP_PLACES.MAP_21, MAP_PLACES.MAP_09, MAP_PLACES.MAP_23, MAP_PLACES.MAP_08, MAP_PLACES.MAP_02, MAP_PLACES.MAP_10],\n                    equidistant: [MAP_PLACES.MAP_07, MAP_PLACES.MAP_01, MAP_PLACES.MAP_03, MAP_PLACES.MAP_11]\n                }\n            },\n            {\n                label: 'C',\n                position: {\n                    hs: MAP_PLACES.MAP_28,\n                    adjacent: [MAP_PLACES.MAP_29, MAP_PLACES.MAP_13, MAP_PLACES.MAP_27],\n                    slice: [MAP_PLACES.MAP_29, MAP_PLACES.MAP_13, MAP_PLACES.MAP_27, MAP_PLACES.MAP_14, MAP_PLACES.MAP_04, MAP_PLACES.MAP_12],\n                    equidistant: [MAP_PLACES.MAP_05, MAP_PLACES.MAP_15, MAP_PLACES.MAP_03, MAP_PLACES.MAP_11]\n                }\n            },\n        ],\n    },\n    [MAP_OPTION.FOUR_PLAYER]: {\n        name: 'Four player',\n        systems: {\n            blue: 20,\n            red: 12,\n        },\n        players: [\n            {\n                label: 'A',\n                position: {\n                    hs: MAP_PLACES.MAP_36,\n                    adjacent: [MAP_PLACES.MAP_35, MAP_PLACES.MAP_18, MAP_PLACES.MAP_07, MAP_PLACES.MAP_19],\n                    slice: [MAP_PLACES.MAP_35, MAP_PLACES.MAP_18, MAP_PLACES.MAP_07, MAP_PLACES.MAP_19, MAP_PLACES.MAP_20, MAP_PLACES.MAP_01],\n                    equidistant: [MAP_PLACES.MAP_08, MAP_PLACES.MAP_34, MAP_PLACES.MAP_17, MAP_PLACES.MAP_06]\n                }\n            },\n            {\n                label: 'B',\n                position: {\n                    hs: MAP_PLACES.MAP_23,\n                    adjacent: [MAP_PLACES.MAP_22, MAP_PLACES.MAP_09, MAP_PLACES.MAP_10, MAP_PLACES.MAP_24],\n                    slice: [MAP_PLACES.MAP_22, MAP_PLACES.MAP_09, MAP_PLACES.MAP_10, MAP_PLACES.MAP_24, MAP_PLACES.MAP_21, MAP_PLACES.MAP_02],\n                    equidistant: [MAP_PLACES.MAP_08, MAP_PLACES.MAP_03, MAP_PLACES.MAP_11, MAP_PLACES.MAP_25]\n                }\n            },\n            {\n                label: 'C',\n                position: {\n                    hs: MAP_PLACES.MAP_27,\n                    adjacent: [MAP_PLACES.MAP_28, MAP_PLACES.MAP_13, MAP_PLACES.MAP_12, MAP_PLACES.MAP_26],\n                    slice: [MAP_PLACES.MAP_28, MAP_PLACES.MAP_13, MAP_PLACES.MAP_12, MAP_PLACES.MAP_26, MAP_PLACES.MAP_29, MAP_PLACES.MAP_04],\n                    equidistant: [MAP_PLACES.MAP_14, MAP_PLACES.MAP_03, MAP_PLACES.MAP_11, MAP_PLACES.MAP_25]\n                }\n            },\n            {\n                label: 'D',\n                position: {\n                    hs: MAP_PLACES.MAP_32,\n                    adjacent: [MAP_PLACES.MAP_33, MAP_PLACES.MAP_16, MAP_PLACES.MAP_15, MAP_PLACES.MAP_31],\n                    slice: [MAP_PLACES.MAP_33, MAP_PLACES.MAP_16, MAP_PLACES.MAP_15, MAP_PLACES.MAP_31, MAP_PLACES.MAP_05, MAP_PLACES.MAP_30],\n                    equidistant: [MAP_PLACES.MAP_14, MAP_PLACES.MAP_34, MAP_PLACES.MAP_17, MAP_PLACES.MAP_06]\n                }\n            },\n        ]\n    },\n    [MAP_OPTION.SIX_PLAYER]: {\n        name: 'Six player',\n        systems: {\n            blue: 18,\n            red: 12,\n        },\n        players: [\n            {\n                label: 'A',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n            {\n                label: 'B',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n            {\n                label: 'C',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n            {\n                label: 'D',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n            {\n                label: 'E',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n            {\n                label: 'F',\n                position: {\n                    hs: null,\n                    adjacent: [],\n                    slice: [],\n                    equidistant: []\n                }\n            },\n        ]\n    }\n};\n\nconst TILE_DISPLAY_TYPE = {\n    TEXT: 'text',\n    IMAGE: 'image',\n    SVG: 'svg',\n};\n\nexport {\n    MAP_PLACES,\n    MAP_PLACE_POSITION,\n    SYSTEM_PNG_URL,\n    MAP_OPTION,\n    MAP_CONFIG,\n    TILE_DISPLAY_TYPE,\n}\n","import React from 'react';\n\nexport default ({ children }) => (\n    <div className=\"svg-wrapper\">\n        <svg xmlns=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 515 446\" className=\"system-image svg-border\">\n            <path d=\"m 0 223 l 128.75 -223 l 257.5 0 l 128.75 223 l -128.75 223 l -257.5 0 z \" />\n        </svg>\n        {children}\n    </div>\n);","import React, { memo, useState, useEffect } from 'react';\nimport _ from 'lodash';\n\nimport FontFaceObserver from 'fontfaceobserver';\n\nimport 'konva';\nimport { Stage, Layer, Group, Circle, Text, Line, Star } from 'react-konva';\n\nimport {\n  GAME_COLOURS,\n  SYSTEM_TILE_BACK,\n  TECH_COLOR,\n  PLANET_TRAIT,\n  ANOMALY,\n  WORMHOLE,\n} from '../../lib/constants';\n\nconst WIDTH = 119 * 2;\nconst HEIGHT = Math.round(WIDTH * 0.866025);\n\nconst PT = WIDTH * 0.01;\n\nconst COLOR = {\n  WHITE: GAME_COLOURS.WHITE,\n  BLACK: \"#000000\",\n  RED: GAME_COLOURS.RED,\n  GREEN: GAME_COLOURS.GREEN,\n  BLUE: GAME_COLOURS.BLUE,\n  YELLOW: GAME_COLOURS.YELLOW,\n  ORANGE: GAME_COLOURS.ORANGE,\n  PINK: GAME_COLOURS.PINK,\n  GREY: \"#C0C0C0\",\n};\n\nconst OBJECT_TYPE = {\n  PLANET: 'PLANET',\n  ANOMALY: 'ANOMALY',\n  WORMHOLE: 'WORMHOLE',\n};\n\nconst OBJECT_RADIUS = WIDTH * 0.155;\nconst OBJECT_LARGE_RADIUS = WIDTH * 0.23;\nconst OBJECT_STROKE_WIDTH = 2 * PT;\nconst OBJECT_STROKE_DASH = [OBJECT_STROKE_WIDTH * 2, OBJECT_STROKE_WIDTH * 2];\n\nconst TEXT_PROPS = {\n  BASE: {\n    fontFamily: 'Roboto Mono',\n    fontStyle: 'bold',\n    fill: COLOR.WHITE,\n    align: 'center',\n    verticalAlign: 'middle',\n    lineHeight: 1.1,\n  },\n  OBJECT_LABEL: { fontSize: 4.75 * PT },\n  SYSTEM_LABEL: { fontSize: 4.75 * PT },\n  PLANET_VALUES: { fontSize: 9 * PT },\n};\n\nconst TextWithFont = ({ key, ...props }) => {\n  const [fontLoaded, setFontLoaded] = useState(false);\n\n  useEffect(async () => {\n    // TODO: set from text props\n    const font = new FontFaceObserver('Roboto Mono', {\n      weight: 700,\n    });\n    await font.load().catch(function () {\n      console.log('font failed failed to load');\n    });\n    setFontLoaded(true);\n  }, []);\n\n  if (!fontLoaded) return null;\n  return <Text key={key} {...props} />;\n}\n\nconst AnomalyBorder = () => {\n  const width = 2 * PT;\n  const size = WIDTH * 0.09;\n  const corner = (angle) => (\n    <Line\n      points={[\n        0, size * -1,\n        size * 0.5772, 0,\n        0, size,\n      ]}\n      stroke={COLOR.RED}\n      closed={false}\n      strokeWidth={width}\n      x={WIDTH / 2}\n      y={HEIGHT / 2}\n      offsetX={WIDTH * -0.391}\n      rotation={angle}\n    />\n  );\n\n  return (\n    <Group>\n    {corner(-120)}\n    {corner(-60)}\n    {corner(0)}\n    {corner(60)}\n    {corner(120)}\n    </Group>\n  )\n}\n\nconst PlanetIcon = ({ planet, size, ...props }) => {\n  if (!planet) {\n    console.error('No planet', this);\n    return null;\n  }\n\n  if (planet.legendary) return (\n    <Star\n      numPoints={5}\n      fill={COLOR.GREY}\n      offsetY={size * 0.7}\n      outerRadius={size * 0.7}\n      innerRadius={size * 0.35}\n      {...props}\n    />\n  );\n\n  const iconProps = {\n    width: size,\n    height: size,\n    offsetY: size * 0.5,\n    ...props,\n  };\n\n  switch (planet.tech) {\n    case TECH_COLOR.GREEN:\n      iconProps.fill = COLOR.GREEN;\n    break;\n    case TECH_COLOR.YELLOW:\n      iconProps.fill = COLOR.YELLOW;\n    break;\n    case TECH_COLOR.BLUE:\n      iconProps.fill = COLOR.BLUE;\n    break;\n    case TECH_COLOR.RED:\n      iconProps.fill = COLOR.RED;\n    break;\n    default:\n      return null;\n  }\n\n  return <Circle {...iconProps} />;\n};\n\nconst Planet = ({ position, planet }) => {\n  const planetProps = {\n    radius: (planet.mecatol || planet.legendary) ? OBJECT_LARGE_RADIUS : OBJECT_RADIUS,\n    stroke: COLOR.WHITE,\n    strokeWidth: OBJECT_STROKE_WIDTH,\n  };\n  const labelProps = {\n    ...TEXT_PROPS.BASE,\n    ...TEXT_PROPS.OBJECT_LABEL,\n    text: planet.name.toUpperCase(),\n    x: 0,\n    y: 0,\n  };\n\n  const labelMarginY = planetProps.strokeWidth * 2 - labelProps.fontSize * 0.1;\n  const labelMarginX = planetProps.strokeWidth * 2.2;\n\n  switch (position) {\n    case '2,0':\n      labelProps.width = WIDTH * 0.24;\n      labelProps.height = HEIGHT * 0.2;\n      labelProps.x = planetProps.radius + labelMarginX;\n      labelProps.offsetY = labelProps.height * 0.5;\n      labelProps.verticalAlign = 'middle';\n      labelProps.align = 'left';\n    break;\n    case '2,1':\n      labelProps.width = WIDTH * 0.27;\n      labelProps.height = HEIGHT * 0.2;\n      labelProps.offsetX = labelProps.width;\n      labelProps.x = (planetProps.radius + labelMarginX) * -1;\n      labelProps.offsetY = labelProps.height * 0.5;\n      labelProps.verticalAlign = 'middle';\n      labelProps.align = 'right';\n    break;\n    case '3,0':\n      labelProps.width = WIDTH * 0.24;\n      labelProps.height = HEIGHT * 0.2;\n      labelProps.x = planetProps.radius + labelMarginX;\n      labelProps.offsetY = labelProps.height * 0.8;\n      labelProps.verticalAlign = 'middle';\n      labelProps.align = 'left';\n    break;\n    case '3,1':\n      labelProps.width = WIDTH * 0.5;\n      labelProps.height = labelProps.fontSize * labelProps.lineHeight;\n      labelProps.offsetX = labelProps.width;\n      labelProps.x = (planetProps.radius + labelMarginX) * -1;\n      labelProps.offsetY = labelProps.height * 0.5;\n      labelProps.verticalAlign = 'middle';\n      labelProps.align = 'right';\n    break;\n    case '3,2':\n      labelProps.width = WIDTH * 0.24;\n      labelProps.height = HEIGHT * 0.2;\n      labelProps.x = planetProps.radius + labelMarginX;\n      labelProps.offsetY = labelProps.height * 0.2;\n      labelProps.verticalAlign = 'middle';\n      labelProps.align = 'left';\n    break;\n    default:\n      labelProps.width = WIDTH * 0.5;\n      labelProps.height = labelProps.fontSize * labelProps.lineHeight;\n      labelProps.offsetX = labelProps.width * 0.5;\n      labelProps.offsetY = labelProps.height;\n      labelProps.y = planetProps.radius * -1 - labelMarginY\n      labelProps.verticalAlign = 'bottom';\n  }\n\n  switch (planet.trait) {\n    case PLANET_TRAIT.BLUE:\n      planetProps.stroke = COLOR.BLUE;\n      labelProps.fill = COLOR.BLUE;\n    break;\n    case PLANET_TRAIT.RED:\n      planetProps.stroke = COLOR.RED;\n      labelProps.fill = COLOR.RED;\n    break;\n    case PLANET_TRAIT.GREEN:\n      planetProps.stroke = COLOR.GREEN;\n      labelProps.fill = COLOR.GREEN;\n    break;\n  }\n\n  const planetValueProps = {\n    ...TEXT_PROPS.BASE,\n    ...TEXT_PROPS.PLANET_VALUES,\n    text: `${planet.resources}/${planet.influence}`,\n    width: planetProps.radius * 2,\n  };\n\n  const iconSize = 6 * PT;\n  const iconMargin = planetValueProps.fontSize * 0.5;\n  const icon = (planet.tech || planet.legendary) ? <PlanetIcon planet={planet} y={iconMargin * -0.8} size={iconSize} /> : null;\n\n  planetValueProps.height = planetValueProps.fontSize * planetValueProps.lineHeight;\n  planetValueProps.offsetX = planetValueProps.width * 0.5;\n  planetValueProps.offsetY = planetValueProps.height * 0.5;\n\n  if (icon) {\n    planetValueProps.y = (iconSize * 0.5) + (iconMargin * 0.3);\n  }\n\n  return (\n    <>\n      <Circle {...planetProps} />\n      {icon}\n      <TextWithFont {...planetValueProps} />\n      {/* <Rect {..._.pick(labelProps, ['x', 'y', 'width', 'height', 'offsetX', 'offsetY'])} fill=\"#00ffff\" opacity={0.5} /> */}\n      <TextWithFont {...labelProps} />\n    </>\n  );\n}\n\nconst AnomalyObject = ({ type }) => {\n  const textBoxSize = radius => ({ width: radius * 1.8, height: radius * 1.8, offsetX: radius * 0.9, offsetY: radius * 0.9 })\n\n  switch (type) {\n    case ANOMALY.SUPERNOVA:\n      return (\n        <>\n          <Circle\n            radius={OBJECT_LARGE_RADIUS}\n            fill={COLOR.ORANGE}\n          />\n          <TextWithFont\n            {...TEXT_PROPS.BASE}\n            {...TEXT_PROPS.OBJECT_LABEL}\n            text={type.toUpperCase()}\n            fill={COLOR.BLACK}\n            {...textBoxSize(OBJECT_LARGE_RADIUS)}\n          />\n        </>\n      );\n    case ANOMALY.ASTEROID_FIELD:\n      return (\n        <>\n          <Circle\n            radius={OBJECT_RADIUS}\n            stroke={COLOR.GREY}\n            strokeWidth={OBJECT_STROKE_WIDTH}\n            dash={OBJECT_STROKE_DASH}\n          />\n          <TextWithFont\n            {...TEXT_PROPS.BASE}\n            {...TEXT_PROPS.OBJECT_LABEL}\n            text={type.toUpperCase()}\n            fill={COLOR.GREY}\n            {...textBoxSize(OBJECT_RADIUS)}\n          />\n        </>\n      );\n    case ANOMALY.NEBULA:\n      return (\n        <>\n          <Circle\n            radius={OBJECT_RADIUS}\n            stroke={COLOR.PINK}\n            strokeWidth={OBJECT_STROKE_WIDTH}\n            dash={OBJECT_STROKE_DASH}\n          />\n          <TextWithFont\n            {...TEXT_PROPS.BASE}\n            {...TEXT_PROPS.OBJECT_LABEL}\n            text={type.toUpperCase()}\n            fill={COLOR.PINK}\n            {...textBoxSize(OBJECT_RADIUS)}\n          />\n        </>\n      );\n    case ANOMALY.GRAV_RIFT:\n      return (\n        <>\n          <Circle\n            radius={OBJECT_RADIUS}\n            fill={COLOR.GREY}\n          />\n          <TextWithFont\n            {...TEXT_PROPS.BASE}\n            {...TEXT_PROPS.OBJECT_LABEL}\n            text={type.toUpperCase()}\n            fill={COLOR.BLACK}\n            {...textBoxSize(OBJECT_RADIUS)}\n          />\n        </>\n      );\n    default:\n      return null;\n  }\n};\n\nconst WormholeObject = ({ type }) => {\n  const wormholeProps = {};\n\n  switch (type) {\n    case WORMHOLE.A:\n      wormholeProps.color = COLOR.ORANGE;\n      wormholeProps.text = '';\n    break;\n    case WORMHOLE.B:\n      wormholeProps.color = COLOR.GREEN;\n      wormholeProps.text = '';\n    break;\n    default:\n      return null;\n  }\n  return (\n    <>\n      <Circle\n        radius={OBJECT_RADIUS}\n        stroke={wormholeProps.color}\n        strokeWidth={OBJECT_STROKE_WIDTH}\n        dash={OBJECT_STROKE_DASH}\n      />\n      <TextWithFont\n        {...TEXT_PROPS.BASE}\n        fontFamily=\"sans-serif\"\n        text={wormholeProps.text}\n        fill={wormholeProps.color}\n        fontSize={OBJECT_RADIUS * 0.8}\n        width={OBJECT_RADIUS * 2}\n        height={OBJECT_RADIUS * 2}\n        offsetX={OBJECT_RADIUS}\n        offsetY={OBJECT_RADIUS}\n      />\n    </>\n  );\n}\n\nconst SystemObject = ({ position, type, object }) => {\n  switch (type) {\n    case OBJECT_TYPE.PLANET: return <Planet planet={object} position={position} />;\n    case OBJECT_TYPE.ANOMALY: return <AnomalyObject type={object} />;\n    case OBJECT_TYPE.WORMHOLE: return <WormholeObject type={object} />;\n  }\n}\n\nconst SystemObjects = ({ system }) => {\n  const objects = [];\n  if (_.get(system, 'planets.length') >= 1) {\n    objects.push(...system.planets.map(planet => [OBJECT_TYPE.PLANET, planet]));\n  }\n\n  if (system.anomaly) objects.push([OBJECT_TYPE.ANOMALY, system.anomaly]);\n  if (system.wormhole) objects.push([OBJECT_TYPE.WORMHOLE, system.wormhole]);\n\n  return objects.map(([objectType, object], i) => {\n    const position = `${objects.length},${i}`;\n    const positionProps = {};\n    switch (position) {\n      case '2,0': positionProps.x = WIDTH * 0.40; positionProps.y = HEIGHT * 0.29; break;\n      case '2,1': positionProps.x = WIDTH * 0.60; positionProps.y = HEIGHT * 0.70; break;\n      case '3,0': positionProps.x = WIDTH * 0.39; positionProps.y = HEIGHT * 0.26; break;\n      case '3,1': positionProps.x = WIDTH * 0.74; positionProps.y = HEIGHT * 0.50; break;\n      case '3,2': positionProps.x = WIDTH * 0.39; positionProps.y = HEIGHT * 0.74; break;\n      default:\n        positionProps.x = WIDTH / 2;\n        positionProps.y = HEIGHT / 2;\n    }\n    return (\n      <Group\n        key={i}\n        {...positionProps}\n      >\n        <SystemObject\n          position={position}\n          type={objectType}\n          object={object}\n        />\n      </Group>\n    );\n  });\n};\n\nconst SystemNumber = ({ system }) => {\n  const labelProps = {\n    ...TEXT_PROPS.BASE,\n    ...TEXT_PROPS.SYSTEM_LABEL,\n    text: system.number,\n    x: WIDTH * 0.5,\n    y: HEIGHT * 0.5,\n    width: WIDTH * 0.86,\n    align: 'left',\n  };\n\n  labelProps.height = labelProps.fontSize * 2;\n  labelProps.offsetX = labelProps.width / 2;\n  labelProps.offsetY = labelProps.height / 2;\n\n  switch (system.back) {\n    case SYSTEM_TILE_BACK.RED:\n      labelProps.fill = COLOR.RED;\n    break;\n    case SYSTEM_TILE_BACK.BLUE:\n      labelProps.fill = COLOR.BLUE;\n    break;\n    default:\n      labelProps.fill = COLOR.GREY;\n  }\n\n  return <Text {...labelProps} />;\n};\n\nconst SystemTileContents = ({ system }) => (\n  <Stage width={WIDTH} height={HEIGHT}>\n    <Layer>\n      {system.anomaly ? <AnomalyBorder /> : null}\n      <SystemNumber system={system} />\n      <SystemObjects system={system} />\n    </Layer>\n  </Stage>\n);\n\nexport default memo(SystemTileContents, (prevProps, nextProps) => _.isEqual(_.get(prevProps, 'system.number'), _.get(nextProps, 'system.number')));\n","import React from 'react';\nimport { useDrag } from 'react-dnd';\nimport _ from 'lodash';\n\nimport {\n  SYSTEMS,\n} from '../../lib/constants';\nimport { SYSTEM_PNG_URL, TILE_DISPLAY_TYPE } from './map-constants';\n\nimport SystemTileSVG from './SystemTileSVG';\nimport SystemTileKonvaStage from './SystemTileKonvaStage';\n\nconst SystemTileContent = ({ number, type }) => {\n  const system = _.find(SYSTEMS, { number });\n\n  if (!system) return null;\n\n  if (type === TILE_DISPLAY_TYPE.TEXT) {\n    return <span className=\"tile-label\">{number}</span>;\n  }\n\n  if (type === TILE_DISPLAY_TYPE.IMAGE) {\n    return <img src={`${SYSTEM_PNG_URL}${number}.png`} alt={`System ${number}`} className=\"system-image\" draggable={false} />;\n  }\n\n  return (\n    <SystemTileSVG><SystemTileKonvaStage system={system} /></SystemTileSVG>\n  );\n}\n\nconst SystemTile = ({ system, style = {}, contentType, locked, toggleLocked, ...props }) => {\n    const [collected, dragRef] = useDrag(\n      () => ({\n        type: 'TILE',\n        item: { system },\n        canDrag: () => !locked,\n        collect: (monitor) => ({\n          isDragging: monitor.isDragging()\n        }),\n      }),\n      [system, locked, props.place]\n    );\n\n    const classes = ['system-tile'];\n    if (contentType) classes.push(`content-${contentType}`);\n    if (collected.isDragging) {\n      classes.push('is-dragging');\n    }\n\n    if (locked) {\n      classes.push('locked');\n    }\n\n    // style.backgroundImage = placeBackground({ system });\n    return (\n      <div\n        className={classes.join(' ')}\n        style={style} ref={dragRef}\n        onDoubleClick={toggleLocked || null}\n        role=\"button\"\n      >\n        <SystemTileContent\n          number={system}\n          type={contentType}\n        />\n      </div>\n    );\n};\n\nexport default SystemTile;\n","import React from 'react';\nimport _ from 'lodash';\n\nimport { SYSTEM_PNG_URL, TILE_DISPLAY_TYPE } from './map-constants';\n\nimport SystemTileSVG from './SystemTileSVG';\n\nconst SystemTileContent = ({ type, player }) => {\n  if (type === TILE_DISPLAY_TYPE.TEXT) {\n    return null;\n  }\n\n  if (type === TILE_DISPLAY_TYPE.IMAGE) {\n    // TODO (maybe)\n    return <img src={`${SYSTEM_PNG_URL}HS-${player}.png`} alt=\"Home system\" className=\"system-image\" draggable={false} />;\n  }\n\n  return <SystemTileSVG />;\n}\n\nconst HomeSystemTile = ({ player, style = {}, contentType }) => {\n    return (\n      <div className={`system-tile locked home-system content-${contentType}`} style={style}>\n        <SystemTileContent type={contentType} player={player} />\n        <span className=\"tile-label\">{player}</span>\n      </div>\n    );\n};\n\nexport default HomeSystemTile;\n","import React, { useEffect } from 'react';\nimport { useDrop } from 'react-dnd';\nimport _ from 'lodash';\n\nimport { URL } from '../../lib/constants';\nimport { MAP_PLACE_POSITION } from './map-constants';\n\nimport SystemTile from './SystemTile';\nimport HomeSystemTile from './HomeSystemTile';\n\nconst placeWrapperStyle = ({ place }) => {\n    const position = _.get(MAP_PLACE_POSITION, place);\n\n    const style = {\n        left: _.get(position, 'left') || null,\n        top: _.get(position, 'top') || null,\n        zIndex: _.get(position, 'zIndex') || null,\n    };\n\n    return style;\n}\n\nconst MapPlace = ({\n    place,\n    system = null,\n    playerHome = null,\n    contentType,\n    moveTile,\n    locked,\n    unavailable,\n    toggleLockedPlace,\n    ...props\n}) => {\n    const [{ isOver, canDrop }, dropRef] = useDrop({\n        accept: 'TILE',\n        drop: ({ system }) => { moveTile(system, place) },\n        canDrop: () => !(locked || unavailable),\n        collect: (monitor) => ({\n            isOver: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        })\n    });\n    \n    const classes = ['map-place-wrapper'];\n    if (isOver) {\n        classes.push(canDrop ? 'can-drop' : 'no-drop');\n    }\n    if (locked) {\n        classes.push('locked');\n    }\n    if (unavailable) {\n        classes.push('unavailable');\n    }\n\n\n    return (\n        <div\n            key={place}\n            className={classes.join(' ')}\n            style={placeWrapperStyle({ place })}\n            ref={dropRef}\n            role=\"button\"\n            onDoubleClick={() => { toggleLockedPlace(place); }}\n        >\n            {playerHome && <HomeSystemTile player={playerHome} contentType={contentType} place={place} />}\n            {system && (\n                <SystemTile\n                    place={place}\n                    system={system}\n                    contentType={contentType}\n                    locked={locked}\n                    unavailable={unavailable}\n                />\n            )}\n            {!unavailable && <span className=\"marker-dot\" />}\n        </div>\n    );\n};\n\nexport default MapPlace;","import React, { useState } from 'react';\nimport _ from 'lodash';\n\nimport MapPlace from './MapPlace';\n\nconst MapContainer = ({\n    mapPlaceData,\n    displayType,\n    moveTile,\n    className = '',\n    toggleLockedPlace,\n    ...props\n}) => {\n    return (\n        <div className={`map-container ${className}`} {...props}>\n            {_.toPairs(mapPlaceData).map(([place, { system, hs, locked, unavailable }]) => {\n                return (\n                    <MapPlace\n                        key={place}\n                        place={place}\n                        system={system}\n                        playerHome={hs}\n                        locked={locked}\n                        unavailable={unavailable}\n                        contentType={displayType}\n                        moveTile={moveTile}\n                        toggleLockedPlace={toggleLockedPlace}\n                    />\n                );\n            })}\n        </div>\n    );\n}\n\nexport default MapContainer;","import React from 'react';\nimport { useDrop } from 'react-dnd';\nimport _ from 'lodash';\n\nimport { MAP_PLACES } from './map-constants';\n\nimport SystemTile from './SystemTile';\n\nconst TileDisplay = ({\n    systems = [],\n    moveTile,\n    displayType,\n    ...props\n}) => {\n    const [{ isOver, canDrop }, dropRef] = useDrop({\n        accept: 'TILE',\n        drop: ({ system }) => { moveTile(system, null) },\n        // canDrop: () => true,\n        collect: (monitor) => ({\n            isOver: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        })\n    });\n\n    return (\n        <div className=\"tile-display-container\" ref={dropRef}>\n            <div style={{ width: '100%' }}>{systems.length}</div>\n            {systems.map(system => <SystemTile key={system} system={system} contentType={displayType} />)}\n        </div>\n    );\n};\n\nexport default TileDisplay;","import React, { useState, memo, Fragment } from 'react';\nimport _ from 'lodash';\n\nimport { SYSTEMS, PLANET_TRAIT, WORMHOLE } from '../../lib/constants';\n\nconst summariseSystems = (systems) => {\n    const summary = {\n        tiles: systems.length\n    };\n\n    const planets = _.chain(systems).map('planets').flatten().value();\n    \n    summary.planets = planets.length;\n    summary.resources = _.sumBy(planets, 'resources');\n    summary.influence = _.sumBy(planets, 'influence');\n    summary.efficientValue = _.sumBy(planets, ({ resources, influence }) => _.max([resources, influence]));\n    summary.tech = _.sumBy(planets, ({ tech }) => tech ? 1 : 0);\n    summary.legendary = _.sumBy(planets, ({ legendary }) => legendary ? 1 : 0);\n    summary.traits = {\n        [PLANET_TRAIT.BLUE]: _.sumBy(planets, ({ trait }) => trait === PLANET_TRAIT.BLUE ? 1 : 0),\n        [PLANET_TRAIT.GREEN]: _.sumBy(planets, ({ trait }) => trait === PLANET_TRAIT.GREEN ? 1 : 0),\n        [PLANET_TRAIT.RED]: _.sumBy(planets, ({ trait }) => trait === PLANET_TRAIT.RED ? 1 : 0),\n    };\n\n    summary.anomalies = _.sumBy(systems, ({ anomaly }) => anomaly ? 1 : 0);\n    summary.wormholes = _.sumBy(systems, ({ wormhole }) => wormhole ? 1 : 0);\n    summary.nonPlanet = _.sumBy(systems, ({ planets = [] }) => planets.length === 0 ? 1 : 0);\n\n    return summary;\n};\n\nconst SYSTEM_GROUPS = {\n    ADJACENT: 'Adjacent',\n    SLICE: 'Slice',\n    EQUIDISTANT: 'Equidistant',\n};\n\nconst StatsTable = ({ mapPlaceData, mapConfig}) => {\n    const [includedSystems, setIncludedSystems] = useState([SYSTEM_GROUPS.SLICE]);\n\n    const setIncludedSystemGroup = (group, checked) => {\n        setIncludedSystems((prevGroups) => _.chain(SYSTEM_GROUPS)\n            .values()\n            .filter((includedGroup) => {\n                if (includedGroup === group) return checked;\n                return prevGroups.indexOf(includedGroup) >= 0;\n            })\n            .value()\n        );\n    };\n\n    const players = mapConfig.players.map((player) => {\n        player.systems = _.mapValues({\n            [SYSTEM_GROUPS.ADJACENT]: player.position.adjacent,\n            [SYSTEM_GROUPS.SLICE]: _.uniq([...player.position.adjacent, ...player.position.slice]),\n            [SYSTEM_GROUPS.EQUIDISTANT]: _.uniq([...player.position.adjacent, ...player.position.slice, ...player.position.equidistant]),\n        }, (places) => {\n            const systems = _.uniq(places)\n            .map((place) => {\n                const system = _.find(SYSTEMS, { number: _.get(mapPlaceData, `${place}.system`) });\n                return system;\n            })\n            .filter(system => system);\n            return summariseSystems(systems);\n        })\n        return player;\n    });\n\n    return (\n        <div className=\"map-stats-wrapper\">\n            <div>\n                {_.toPairs(SYSTEM_GROUPS).map(([key, group]) => (\n                    <div className=\"form-check form-check-inline\" key={group}>\n                        <input\n                            className=\"form-check-input\"\n                            type=\"checkbox\"\n                            id={`includeSystems-${key}`}\n                            value={group}\n                            checked={includedSystems.indexOf(group) >= 0}\n                            onChange={(e) => {\n                                setIncludedSystemGroup(group, e.target.checked);\n                            }}\n                        />\n                        <label className=\"form-check-label\" htmlFor={`includeSystems-${key}`}>{group}</label>\n                    </div>\n                ))}\n            </div>\n            <div className=\"table-responsive\">\n                <table className=\"table map-stats-table\">\n                    <thead><tr>\n                        <th colSpan=\"2\"></th>\n                        <th className=\"vertical\"><span>Planets</span></th>\n                        <th className=\"vertical\"><span>Resources</span></th>\n                        <th className=\"vertical\"><span>Influence</span></th>\n                        <th className=\"vertical\"><span>Efficient value</span></th>\n                        <th className=\"vertical\"><span>Legendary planets</span></th>\n                        <th className=\"vertical\"><span>Tech specialties</span></th>\n                        <th className=\"vertical\"><span>Cultural traits</span></th>\n                        <th className=\"vertical\"><span>Industrial traits</span></th>\n                        <th className=\"vertical\"><span>Hazardous traits</span></th>\n                        <th className=\"vertical\"><span>Anomalies</span></th>\n                        <th className=\"vertical\"><span>Wormholes</span></th>\n                        <th className=\"vertical\"><span>No-planet systems</span></th>\n                    </tr></thead>\n                    <tbody>\n                        {players.map((player) => (\n                            <Fragment key={player.label}>\n                                {includedSystems.map((systemGroup, systemGroupIdx) => (\n                                    <tr\n                                        key={systemGroup}\n                                        className={\n                                            [\n                                                'row-group',\n                                                (systemGroupIdx === 0 ? 'row-group-first' : ''),\n                                                (systemGroupIdx === (includedSystems.length - 1) ? 'row-group-last' : ''),\n                                            ].join(' ')\n                                        }\n                                    >\n                                        {systemGroupIdx === 0 && <td rowSpan={includedSystems.length}>{player.label}</td>}\n                                        <td>{systemGroup}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].planets || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].resources || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].influence || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].efficientValue || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].legendary || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].tech || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].traits[PLANET_TRAIT.BLUE] || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].traits[PLANET_TRAIT.GREEN] || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].traits[PLANET_TRAIT.RED] || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].anomalies || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].wormhole || 0}</td>\n                                        <td className=\"text-center\">{player.systems[systemGroup].nonPlanet || 0}</td>\n                                    </tr>\n                                ))}\n                            </Fragment>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n}\n\nconst memoCompare = ({ _memo: oldProps }, { _memo: newProps }) => _.isEqual(oldProps, newProps);\n\nexport default memo(StatsTable, memoCompare);","import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport './styles/modal.css';\n\nclass Modal extends Component {\n    constructor() {\n        super();\n        this.state = { show: false };\n\n        this.transitionDelay = 200;\n\n        this.setShow = this.setShow.bind(this);\n        this.keyboardClose = this.keyboardClose.bind(this);\n        this.close = this.close.bind(this);\n        this.renderContents = this.renderContents.bind(this);\n    }\n\n    componentDidMount() {\n        if (this.props.show) {\n            this.setState({ show: true });\n        }\n        document.addEventListener('keydown', this.keyboardClose);\n    }\n\n    componentDidUpdate(oldProps) {\n        if (oldProps.show !== this.props.show) {\n            this.setShow(this.props.show);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.transitionTimeout) {\n            clearTimeout(this.transitionTimeout);\n        }\n        document.removeEventListener('keydown', this.keyboardClose);\n    }\n\n    setShow(show) {\n        this.setState({ show, transitioning: true });\n        this.transitionTimeout = setTimeout(() => { this.setState({ transitioning: false }) }, this.transitionDelay);\n    }\n\n    keyboardClose(event) {\n        // console.log('keyboardClose', this);\n        if (!(this.state.show || this.props.show)) return;\n        const { key } = event;\n        if (key === 'Escape') this.close();\n    }\n\n    close() {\n        if (this.props.dismissible === false) return; \n        if (this.props.onClose) this.props.onClose();\n    }\n\n    renderContents() {\n        const { custom, children, size } = this.props;\n        if (custom) {\n            return <div className=\"modal-custom\">{children}</div>;\n        }\n\n        let modalSize = size ? `modal-${size}` : '';\n\n        return (\n            <div className={`modal-dialog ${modalSize}`}>\n                <div className=\"modal-content\">\n                    {children}\n                </div>\n            </div>\n        );\n    }\n\n    render() {\n        const { portal = true, fade = true, custom, className = '' } = this.props;\n\n        if (!this.renderContents()) return null;\n\n        const wrapperClasses = className.split(' ');\n        wrapperClasses.push('modal-wrapper');\n        if (portal) {\n            wrapperClasses.push('modal-portal');\n        } else {\n            wrapperClasses.push('modal-inline');\n        }\n        if (this.state.transitioning) wrapperClasses.push('modal-transitioning');\n        if (this.state.show) wrapperClasses.push('modal-open');\n\n        const classes = [];\n        classes.push('modal');\n\n        if (fade) classes.push('fade');\n\n        if (this.state.show) classes.push('show');\n\n        const modalWrapper = (\n            <div className={wrapperClasses.join(' ')}>\n                <div\n                    className={classes.join(' ')}\n                >\n                    {this.renderContents()}\n                    <div className=\"modal-backdrop fade\" onClick={this.close} />\n                </div>\n            </div>\n        );\n\n        if (portal) {\n            const portalNode = document.getElementById('portal-modal');\n            if (!portalNode) return null;\n            return createPortal(modalWrapper, portalNode);\n        }\n\n        return modalWrapper;\n    }\n}\n\nModal.CloseButton = ({ onClose, floating }) => {\n    const button = (\n        <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" onClick={onClose}>\n            <span aria-hidden=\"true\">&times;</span>\n        </button>\n    );\n    if (floating) {\n        return <div className=\"floating-close-button\">{button}</div>;\n    }\n    return button;\n};\n\nModal.Header = ({ children, onClose, title }) => (\n    <div className=\"modal-header\">\n        {title && <h5 className=\"modal-title\">{title}</h5>}\n        {onClose && <Modal.CloseButton onClose={onClose} />}\n        {children}\n    </div>\n)\n\nModal.Body = ({ children, className = \"\" }) => <div className={`modal-body ${className}`}>{children}</div>;\nModal.Footer = ({ children }) => <div className=\"modal-footer\">{children}</div>;\n\nexport default Modal;\n","import React, { useState, useEffect } from 'react';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\n\nimport { Modal } from '../common';\n\nconst MapStringModal = ({ show, onChange, onClose, ...props }) => {\n    const [value, setValue] = useState(props.value);\n    \n    useEffect(() => {\n        if (show) {\n            setValue(props.value);\n        }\n    }, [props.value, show]);\n\n    const cleanupString = (initialValue = value) => {\n        const clean = (initialValue || '').replace(/[^\\d\\s]|^\\s+/g, '').replace(/\\s+/g, ' ');\n        return clean;\n    }\n\n    return (\n        <Modal\n            show={show}\n            // onClose={onClose}\n            size=\"lg\"\n        >\n            <Modal.Header\n                onClose={onClose}\n                title=\"TTS Map string\"\n            />\n            <Modal.Body>\n                <textarea\n                    className=\"form-control\"\n                    onChange={(e) => {\n                        setValue(e.target.value || '')\n                    }}\n                    value={value || ''}\n                    onBlur={(e) => { setValue(cleanupString(e.target.value)); }}\n                    // style={{ borderBottomRightRadius: 0, borderBottomLeftRadius: 0 }}\n                />\n            </Modal.Body>\n            <Modal.Footer>\n                <button className=\"btn btn-outline-dark ml-1\" onClick={() => {\n                    if (onChange) onChange(cleanupString(value));\n                    if (onClose) onClose();\n                }}>Save</button>\n                <CopyToClipboard text={value}>\n                    <button className=\"btn btn-outline-primary ml-1\">Copy</button>\n                </CopyToClipboard>\n            </Modal.Footer>\n        </Modal>\n    )\n}\n\nexport default MapStringModal;","import React, { useState, useEffect, useLayoutEffect } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport _ from 'lodash';\n\n\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nimport utils from '../../lib/utils';\nimport { SYSTEMS } from '../../lib/constants';\nimport {\n    MAP_PLACES,\n    MAP_CONFIG,\n    MAP_OPTION,\n    TILE_DISPLAY_TYPE,\n} from './map-constants';\n\nimport MapContainer from './MapContainer';\nimport TileDisplay from './TileDisplay';\nimport StatsTable from './StatsTable';\nimport MapStringModal from './MapStringModal';\n\nimport './styles.css';\n\nconst STORAGE_KEYS = {\n    MAP_DATA: 'map_data',\n    MAP_OPTION: 'map_option',\n};\n\n\nconst defaultMapPlaceData = (mapConfig) => {\n    const placeData = _.mapValues(MAP_PLACES, (v, k) => {\n        switch (k) {\n            case MAP_PLACES.MAP_00:\n                return { system: 18, locked: true };\n            default:\n                return { system: null, unavailable: true };\n        }\n    });\n\n    mapConfig.players.forEach((player) => {\n        placeData[player.position.hs].hs = player.label;\n        _.uniq([\n            ...player.position.adjacent,\n            ...player.position.slice,\n            ...player.position.equidistant,\n        ]).forEach((place) => {\n            delete placeData[place].locked;\n            delete placeData[place].unavailable;\n        })\n    });\n\n    return placeData;\n}\n\nconst getMapString = (data) => {\n    const string = _.chain(data)\n        .toPairs()\n        .filter(([place]) => (place || '').match(/^MAP_/))\n        .sortBy(0)\n        .map(([place, data]) => (data.system || '0').toString(10))\n        .value()\n        .join(' ');\n    \n    return string.replace(/(\\s+0*)+$/, '');\n};\n\nconst parseMapString = (string) => {\n    const systems = _.chain(string)\n        .replace(/^\\D+|\\D+$/g, '')\n        .split(/\\D+/)\n        .filter()\n        .map(_.parseInt)\n        .value();\n\n    return _.chain(MAP_PLACES)\n        .toPairs()\n        .sortBy(0)\n        .map(([place]) => ({ place, system: _.get(systems, parseInt(place.substr(-2), 10)) || null }))\n        .filter(({ place, system }) => place && system)\n        .value();\n};\n\nconst cleanMapData = (data) => {\n    const usedSystems = [];\n    return _.chain(data)\n    .toPairs()\n    .sortBy(0)\n    .fromPairs()\n    .mapValues((place) => {\n        if (place.system && usedSystems.indexOf(place.system) >= 0) {\n            place.system = null;\n        } else {\n            usedSystems.push(place.system);\n        }\n        if (!place.system) delete place.system;\n        if (!place.locked) delete place.locked;\n        if (!place.unavailable) delete place.unavailable;\n        return place;\n    })\n    .value();\n}\n\nconst useInitialMapState = () => {\n    const location = useLocation();\n    const query = new URLSearchParams(`?${location.hash.replace(/^[?#]+/, '')}`);\n\n    console.log({ location, query });\n\n    const mapOption = () => {\n        const option = query.get('o') || window.localStorage.getItem(STORAGE_KEYS.MAP_OPTION);\n        return _.get(MAP_CONFIG, option) ? option : null;\n    };\n    const mapPlaceData = () => {\n        if (query.get('s')) {\n            const data = {};\n            parseMapString(query.get('s')).forEach(({ place, system }) => {\n                data[place] = { system };\n            });\n            return data;\n        }\n\n        return utils.parseJSON(window.localStorage.getItem(STORAGE_KEYS.MAP_DATA));\n    }\n\n    return { initialMapOption: mapOption(), initialMapPlaceData: mapPlaceData() }; \n}\n\nconst MapBuilder = () => {\n    const location = useLocation();\n    const history = useHistory();\n\n    const { initialMapOption, initialMapPlaceData } = useInitialMapState();\n\n    console.log({ initialMapOption, initialMapPlaceData });\n\n    const [mapOption, setMapOption] = useState(initialMapOption || MAP_OPTION.FOUR_PLAYER);\n    const [mapPlaceData, setMapPlaceData] = useState(initialMapPlaceData || {});\n    const [tileDisplayType, setTileDisplayType] = useState(TILE_DISPLAY_TYPE.IMAGE);\n    const [mapString, setMapString] = useState('');\n    const [mapStringDialog, setMapStringDialog] = useState(false);\n\n    useEffect(() => {\n        resetMapConfig(MAP_CONFIG[mapOption]);\n        window.localStorage.setItem(STORAGE_KEYS.MAP_OPTION, mapOption);\n    }, [mapOption]);\n\n    useEffect(() => {\n        setMapString(getMapString(mapPlaceData));\n        window.localStorage.setItem(STORAGE_KEYS.MAP_DATA, JSON.stringify(cleanMapData(mapPlaceData)));\n    }, [mapPlaceData]);\n\n    // useEffect(() => {\n    //     console.log({ mapString });\n    // }, [mapString]);\n\n    useLayoutEffect(() => {\n        if (location.hash) {\n            history.replace({ hash: null });\n        }\n    });\n\n    const unassignedSystems = _.chain(SYSTEMS)\n        .map('number')\n        .without(\n            ..._.chain(mapPlaceData)\n            .values()\n            .filter('system')\n            .map('system')\n            .value()\n        )\n        .sort()\n        .value();\n\n    const moveTiles = (tiles) => {\n        if (mapPlaceData.locked || mapPlaceData.unavailable) {\n            console.log('Place is locked');\n            return;\n        };\n\n        const alreadyMoved = [];\n        \n        const newState = _.clone(mapPlaceData);\n        tiles.forEach(({ system, place }) => {\n            if (place) {\n                if (alreadyMoved.indexOf(system) >= 0) return;\n                if (newState[place]) {\n                    if (newState[place].unavailable) return;\n                    if (newState[place].locked) return;\n                }\n            }\n            if (!_.find(SYSTEMS, { number: system })) return;\n            const existingSystem = _.get(mapPlaceData, `${place}.system`);\n            const prevPlace = _.findKey(mapPlaceData, { system });\n\n            if (prevPlace) {\n                newState[prevPlace].system = existingSystem || null;\n            }\n            if (newState[place]) {\n                newState[place].system = system;\n            }\n\n            if (place) {\n                alreadyMoved.push(system);\n            }\n        });\n        setMapPlaceData(cleanMapData(newState));\n    };\n\n    const moveTile = (system, place) => moveTiles([{ system, place }]);\n\n    const toggleLockedPlace = (place) => {\n        setMapPlaceData((prevState) => {\n            const newPlaceData = _.clone(prevState[place]);\n            newPlaceData.locked = !newPlaceData.locked;\n            return { ...prevState, ...{ [place]: newPlaceData } };\n        });\n    };\n\n    const resetMapConfig = (config = MAP_CONFIG[mapOption]) => {\n        const defaultData = defaultMapPlaceData(config);\n\n        _.chain(mapPlaceData)\n        .entries()\n        .value()\n        .forEach(([place, { system, locked }]) => {\n            if (!(system || locked)) return;\n            if (defaultData[place].unavailable || defaultData[place].locked) return;\n\n            defaultData[place].system = system;\n            defaultData[place].locked = locked;\n        });\n\n        setMapPlaceData(defaultData);\n    };\n\n    const emptyMap = () => _.chain(mapPlaceData)\n        .pickBy(data => data.system && !data.locked && !data.unavailable)\n        .values()\n        .map(({ system }) => ({ system, place: null }))\n        .value()\n\n    const shuffledMap = () => {\n        const randomSystems = _.chain(SYSTEMS)\n            .map('number')\n            .without(\n                ..._.chain(mapPlaceData)\n                .values()\n                .filter(data => data.locked || data.unavailable)\n                .map('system')\n                .value()\n            )\n            .shuffle()\n            .value();\n\n        return _.chain(mapPlaceData)\n            .pickBy(data => !data.locked && !data.unavailable)\n            .keys()\n            .map((place, i) => ({ place, system: randomSystems[i] || null }))\n            .value();\n    };\n\n    const setMapFromString = (string) => {\n        const empty = emptyMap();\n        const fromString = parseMapString(string);\n        moveTiles([...empty, ...fromString]);\n    }\n\n    return (\n        <div id=\"map-builder\" className=\"container-fluid\">\n            <div className=\"build-area\">\n                <DndProvider backend={HTML5Backend}>\n                    <MapContainer\n                        mapPlaceData={mapPlaceData}\n                        displayType={tileDisplayType}\n                        moveTile={moveTile}\n                        toggleLockedPlace={toggleLockedPlace}\n                        // style={{ opacity: 0 }}\n                    />\n                    <TileDisplay\n                        systems={unassignedSystems}\n                        moveTile={moveTile}\n                        displayType={tileDisplayType}\n                    />\n                </DndProvider>\n            </div>\n            <div className=\"config-options\">\n                <div className=\"form-inline mb-1\">\n                    <label className=\"my-auto\" htmlFor=\"map-option-select\">Map setup</label>\n                    <select\n                        className=\"custom-select ml-1\"\n                        id=\"map-option-select\"\n                        onChange={(e) => { setMapOption(e.target.value); }}\n                        value={mapOption}\n                    >\n                        {_.values(MAP_OPTION).map(key => <option value={key} key={key}>{_.get(MAP_CONFIG, `${key}.name`)}</option>)}\n                    </select>\n\n                    <select\n                        className=\"custom-select ml-1\"\n                        id=\"map-option-select\"\n                        onChange={(e) => { setTileDisplayType(e.target.value); }}\n                        value={tileDisplayType}\n                    >\n                        <option value={TILE_DISPLAY_TYPE.IMAGE}>Full colour</option>\n                        <option value={TILE_DISPLAY_TYPE.SVG}>Lo-fi</option>\n                    </select>\n\n                    <button className=\"btn btn-outline-dark ml-1\" onClick={() => { moveTiles(shuffledMap()); }}>Randomise</button>\n                    <button className=\"btn btn-outline-dark ml-1\" onClick={() => { moveTiles(emptyMap()); }}>Clear</button>\n                    <button className=\"btn btn-outline-dark ml-1\" onClick={() => { setMapStringDialog(true); }}>Map string</button>\n                </div>\n            </div>\n            <div className=\"stat-tables\">\n                <StatsTable\n                    _memo={[mapString, mapOption]} // Just for the memo comparison - only use strings\n                    mapPlaceData={mapPlaceData}\n                    mapConfig={MAP_CONFIG[mapOption] || {}}\n                />\n            </div>\n\n            <MapStringModal\n                show={!!mapStringDialog}\n                onClose={() => { setMapStringDialog(false); }}\n                onChange={(value) => {\n                    setMapFromString(value);\n                }}\n                value={mapString}\n            />\n        </div>\n    );\n};\n\nexport default MapBuilder;\n","import React from \"react\";\nimport _ from 'lodash';\nimport { Router, Route, Switch, Redirect } from \"react-router\";\nimport { createBrowserHistory } from \"history\";\n\n// import Tech from './components/tech';\nimport DiceTable from './components/dice-table';\nimport MapBuilder from './components/map-builder';\n\nimport './styles/app.css';\n\nconst history = createBrowserHistory();\n\nconst Routes = () => {\n  return (\n    <>\n      <div id=\"app-wrapper\">\n        <Router history={history}>\n            <Switch>\n              <Route path=\"/TI4/dice\" component={DiceTable} />\n              <Route path=\"/TI4/map-builder\" component={MapBuilder} />\n              <Route path=\"/\" component={() => <Redirect to=\"/TI4/dice\" />} />\n            </Switch>\n        </Router>\n      </div>\n      <div id=\"portal-modal\" />\n    </>\n  );\n};\n\nexport default Routes;","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport Routes from './routes';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Routes />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}